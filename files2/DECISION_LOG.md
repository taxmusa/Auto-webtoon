# 의사결정 히스토리 (Decision Log)

> 이 문서는 프로젝트 진행 중 내린 주요 결정들과 그 배경을 기록합니다.
> 나중에 "왜 이렇게 했지?" 할 때 참고용입니다.

---

## 2026-02-06

### DEC-001: 아키텍처 - Python FastAPI 단독

**결정**: Python FastAPI 단독 (n8n 미사용)

**검토한 대안들**: n8n 단독 / n8n + Python 하이브리드 / Python 단독 (선택)

**Python 단독을 선택한 이유**:
- 로컬 웹앱 형태에서 n8n 별도 설치/실행 → 사용자 부담 증가
- Python으로 모든 기능 구현 가능
- 단일 프로세스로 관리 간편
- Pillow 한글 텍스트 오버레이는 Python 필수

---

### DEC-002: 배포 형태 - 로컬 웹앱 (.exe)

**결정**: Windows 로컬 웹앱 (Python 서버 + 브라우저 UI)

**검토한 대안들**: Electron 데스크톱 앱 / 순수 웹 SaaS / 로컬 웹앱 (선택)

**선택 이유**:
- Electron 학습 곡선 회피
- UI 개발이 표준 웹 기술로 가능
- 추후 SaaS 전환 시 프론트엔드 코드 재사용 가능
- 설치 파일 크기 작음 (~50MB vs Electron 100-200MB)

---

### DEC-003: 수익 모델 - 일회성 판매

**결정**: 프로그램 일회성 판매 (구독 모델 X)

**이유**:
- AI 비용은 사용자가 직접 부담 (본인 API 키)
- 지속적인 운영 비용 없음
- 사용자마다 사용량이 달라서 정액제 책정 어려움

---

### DEC-004: 씬 검토 체크포인트 2단계

**결정**: 이미지 생성 전/후 2번의 검토 단계 (+ 캡션 검토 1회 = 총 3단계)

**워크플로우**:
```
[씬 내용 생성] → [1차: 내용/대사 검토] → [이미지 생성] → [2차: 이미지 검토] → [3차: 캡션 검토] → [발행]
```

---

### DEC-005: 분야 자동 감지 + 사용자 확인

**결정**: AI가 분야 자동 판단 → 사용자가 확인/수정

**분야별 처리 차이**:
- 전문 분야 (세무/법률/노무/회계/부동산정책): 웹 검색 + 법령 DB 검증
- 일반 분야: 일반 웹 검색

---

### DEC-006: 썸네일 별도 생성

**결정**: 캐러셀 첫 장과 별도로 썸네일 이미지 생성

**이유**: 인스타 피드에서 클릭 유도 중요, 전용 커버 이미지가 더 효과적

---

### DEC-007: 마스코트 캐릭터 (카드뉴스/심플용)

**결정**: 카드뉴스/심플 스타일에 작은 마스코트 캐릭터 옵션 (ON/OFF, 기본 ON)

---

### DEC-008: 콘텐츠 밀도 제한

**결정**: 대사 20자 / 말풍선 2개 / 나레이션 30자 제한 + 경고

---

### DEC-009: 캡틴AI 블로그 참고 기능 반영

**반영 항목**: 그림 스타일 선택, 저장 포맷 옵션, 대사 배치 선택, 캐릭터 프로필 카드, 단계별 이동, Gemini Flash 모델

---

### DEC-010: 이미지 비율 설정

**결정**: 기본 1080x1350px (4:5), 1:1/4:5/9:16/커스텀 지원

---

### DEC-011: 디폴트값 제공

**결정**: 모든 설정에 합리적 디폴트값 → 처음 사용자는 설정 없이 바로 시작

---

### DEC-012: 캡션 자동 생성 구조

**결정**: 4파트 (훅 + 본문 + 전문가팁 + 해시태그 15~20개)

---

### DEC-013: 단계 간 이동

**결정**: 모든 단계에서 이전 단계로 돌아가기 가능. 수정 시 이후 결과물 재생성 필요 알림.

---

### DEC-014: 텍스트 생성 모델 - Gemini Flash

**결정**: Gemini 2.5 Flash 기본 (저렴, 빠름, 무료 티어 넉넉). Pro는 복잡한 내용용 옵션.

---

### DEC-015: 동영상 변환 (Phase 3)

**결정**: Phase 3에서 구현. Kling, Sora, Grok, Runway 후보.

---

## 2026-02-07

### DEC-016: 캐릭터 일관성 시스템 ⭐

**결정**: DNA Template + 레퍼런스 이미지 + LOCKED 속성 조합으로 80~90% 일관성 달성

**검토한 접근법**:
1. 프롬프트 고정만 (60~70%) — 부족
2. 프롬프트 + 레퍼런스 이미지 (75~85%) — 양호
3. 프롬프트 + 캐릭터 시트 + 레퍼런스 (80~90%) — 선택

**핵심 결정사항**:
- Identity Block은 FROZEN string으로 저장, 단어 하나도 변경 금지
- 캐릭터 시트는 2x3 그리드로 1장 생성 (API 호출 절약)
- 색상은 hex 코드, 비율은 숫자로 고정
- 2인 이상 등장 시 LEFT/RIGHT 위치 지정

---

### DEC-017: 이미지 생성 모델 비교 분석

**결정**: DALL-E 3에서 벗어나 다양한 모델 검토

**비교 모델 (12개)**: GPT Image 1/1.5/Mini, Nano Banana/Pro, DALL-E 3, Midjourney v7, Flux 2 Max/Flex, Hunyuan Image 3.0, Seedream 4.5, Ideogram 3.0

**핵심 발견**:
- GPT Image 1 Mini가 DALL-E 3 대비 50~70% 저렴하면서 품질 상위
- DALL-E 3는 레퍼런스 이미지 미지원으로 캐릭터 일관성 최하위
- Hunyuan Image 3.0이 아시아 문화권/웹툰 스타일에서 가장 강력
- 모든 모델이 한글 렌더링 불가 (Pillow 후처리 필수 확인)

> 비교표: AI_IMAGE_MODEL_COMPARISON.md

---

## 2026-02-09

### DEC-018: Kling AI 검토 결과 ⭐

**결정**: Kling은 이미지 생성용으로 부적합, 동영상 변환(Phase 3)에서 재검토

**이유**:
- Kling의 본업은 영상(비디오) 생성 AI
- 이미지 생성("Omni Image 1.0")은 부가 기능 수준
- 크레딧 체계가 비쌈 (영상 1개에 20~120크레딧)
- 웹툰/만화 스타일 프롬프트 충실도 낮음 (실사 영상에 강함)
- Phase 3 동영상 변환 시 Kling이 좋은 후보 (이미지→영상 변환 강점)

---

### DEC-019: 이미지 생성 모델 최종 확정 ⭐⭐

**결정**: GPT Image 3종 + Nano Banana 2종 = 총 5개 모델

**핵심 이유**: 사용자가 이미 보유한 API 키만 사용 (추가 API 발급 불필요)
- OpenAI API 키 → GPT Image 1 Mini / 1 / 1.5
- Google AI Studio 키 → Nano Banana / Nano Banana Pro

**제외 모델과 이유**:
| 모델 | 제외 이유 |
|------|----------|
| DALL-E 3 | GPT Image 1이 완전 상위 호환, 레퍼런스 이미지 미지원 |
| Midjourney v7 | 공식 API 없음 |
| Hunyuan Image 3.0 | 웹툰 최강이나 별도 API 키 필요 (Tencent Cloud) |
| Flux 2 계열 | 별도 API 키 필요 (fal.ai 등) |
| Ideogram 3.0 | 텍스트 특화, 웹툰 비최적 |
| Seedream 4.5 | 서드파티 API 불안정 |

**향후**: 사용자 요청 시 Hunyuan, Flux 등 추가 모델 지원 고려

---

### DEC-020: 스타일 관리 시스템 ⭐⭐

**결정**: 인물 스타일 / 배경 스타일을 별도로 저장·관리하는 시스템 구축

**핵심 기능들**:
1. **스타일 저장 분리**: 인물 스타일(그림체)과 배경 스타일(장소/분위기) 별도 관리
2. **발행물에서 추출**: 기존 인스타툰 업로드 → Vision AI 자동 분석 → 스타일 저장
3. **직접 업로드**: 참고 이미지 → 인물 or 배경 선택하여 스타일 저장
4. **조합 선택**: 인물 스타일 + 배경 스타일 조합하여 이미지 생성
5. **샘플 미리보기**: 전체 생성 전 1장 Low 품질로 확인 (API 비용 절약)
6. **수동 프롬프트 편집**: 샘플 불만족 시 프롬프트 직접 수정

**스타일 vs 캐릭터 구분**:
- 스타일 = "어떤 그림체로?" (선 굵기, 색감, 비율, 조명)
- 캐릭터 = "누가 등장?" (얼굴, 머리, 의상) → CHARACTER_CONSISTENCY.md

**이유**:
- 같은 계정의 웹툰은 주제가 달라도 그림체가 통일되어야 브랜딩 효과
- 기존 발행물이 있으면 새 콘텐츠도 동일 스타일 필요
- 미리보기로 비용 낭비 방지 (Low 품질 1장 ~$0.003)
- 수동 편집으로 세밀한 제어 가능

> 상세: STYLE_SYSTEM.md

---

## 향후 결정 필요 사항

| 항목 | 상태 | 예상 결정 시점 |
|------|------|---------------|
| 가격 책정 | 미정 | 프로그램 완성 후 |
| 자동 업데이트 방식 | 미정 | 사용자 수 증가 시 |
| 다른 플랫폼 지원 | 미정 | Phase 3 |
| 동영상 변환 서비스 선택 | Kling 유력 | Phase 3 |
| Hunyuan/Flux 모델 추가 지원 | 검토 | 사용자 요청 시 |

---

## 변경 이력

| 날짜 | 결정 번호 | 내용 |
|------|----------|------|
| 2026-02-06 | DEC-001~015 | 초기 의사결정 기록 |
| 2026-02-07 | DEC-016~017 | 캐릭터 일관성 시스템, 이미지 모델 비교 |
| 2026-02-09 | DEC-018~019 | Kling 검토, 이미지 모델 최종 확정 (5개) |
| 2026-02-09 | DEC-020 | 스타일 관리 시스템 (인물/배경 분리, 샘플 미리보기, 수동 프롬프트) |
