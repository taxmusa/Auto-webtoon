# 📋 문서 업데이트 지시사항

아래 지시사항을 순서대로 진행해주세요. 기존 파일 내용은 **절대 삭제하지 말고**, 추가/수정만 해주세요.

---

## 작업 1: 신규 파일 3개 추가

아래 3개 파일을 프로젝트의 기획 문서 폴더에 새로 추가해주세요. 내용은 이 메시지 아래에 첨부합니다.

1. **STYLE_SYSTEM.md** — 스타일 관리 시스템 (인물 스타일/배경 스타일 분리 저장, 샘플 미리보기, 수동 프롬프트 편집)
2. **IMAGE_EDIT_STAGE.md** — 이미지 편집 단계 (이미지 생성 후 ~ 텍스트 오버레이 전, 전체 톤 조절 + 씬별 편집)
3. **UPDATE_INSTRUCTIONS.md** — (이 파일 자체, 작업 완료 후 삭제해도 됨)

---

## 작업 2: PRD_MASTER.md 업데이트 (가장 중요!)

### 2-1. 원본에 있었는데 빠진 내용 복원

PRD_MASTER.md에서 아래 내용이 이전 업데이트 때 실수로 빠졌습니다. 아래 내용을 해당 위치에 추가해주세요.

#### ➕ §3에 추가: 워크플로우 상세

현재 §3 "핵심 워크플로우" 바로 아래, 플로우차트 뒤에 추가:

```markdown
### 3.1 단계 간 이동

- 모든 단계에서 **이전 단계로 돌아가기 가능**
- 이전 단계에서 수정하면 이후 결과물 재생성 필요 → 알림 표시
- 예: 씬 검토에서 대사 수정 → 이미지 재생성 필요 안내

### 3.2 두 가지 모드

**자동 모드 (키워드 기반)**:
```
[키워드: 종합소득세 신고] → [AI 판단: 세무 분야] → [사용자: 확인 or 변경]
→ [AI: 자동 정보 수집 + 스토리 생성] → [사용자: 검토/수정] → [이미지 생성]
```

**수동 모드 (직접 입력)**:
1. 분야 직접 선택
2. 참고 자료 직접 입력 또는 붙여넣기
3. 스토리 구성 직접 작성 (씬별)
4. 이미지 프롬프트 직접 입력 (선택)
5. 캡션 직접 작성 (선택)

### 3.3 씬 검토 UI (1차 체크포인트) 상세

```
┌────────────────────────────────────────────────────────────┐
│  생성 완료! 8개의 장면이 생성되었습니다.                      │
│  [전체 이미지 생성]                    [전체 삭제]           │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  [장면 1] 제목: 남편의 선언                                 │
│  나레이션: 1년 전 남편이 선언했죠.                           │
│  대사: 나 개발자가 될 거야!                                 │
│  이미지 프롬프트: 거실 배경, 두 캐릭터가 대화하는 장면...    │
│  ⚠️ 대사 22자 (권장 20자 초과)                              │
│  [편집] [재생성] [삭제] [OK ✓]                              │
│                                                            │
│  [장면 2] 제목: ...                                        │
│  ...                                                       │
│                                                            │
│  📊 전체: 8장면 | 평균 대사: 18자 | 밀도: 적정              │
└────────────────────────────────────────────────────────────┘
```
```

#### ➕ §4.2에 추가: 캐릭터 프리셋과 표정

현재 §4.2 "캐릭터 일관성 시스템" 하단에 추가:

```markdown
#### 캐릭터 프리셋 저장/불러오기

자주 사용하는 캐릭터 조합을 프리셋으로 저장:
- "세무사 + 사업자" 조합 저장
- "변호사 + 의뢰인" 조합 저장
- 프리셋 선택하면 캐릭터가 자동 배정됨

#### 캐릭터 표정 지정

| 모드 | 설명 |
|------|------|
| **자동** (기본) | AI가 대사/나레이션 분석하여 자동 선택 |
| **수동** | 씬별로 직접 선택 가능 |

사용 가능 표정: 기쁨 / 걱정 / 설명(진지) / 놀람 / 화남
```

#### ➕ §4.2 아래에 새 섹션 추가: 스타일 관리 시스템

```markdown
### 4.3 스타일 관리 시스템 ⭐ (v1.4.0)

**인물 스타일과 배경 스타일을 별도로 저장·관리하여 브랜드 일관성 유지**

핵심 기능:
- **스타일 저장**: 인물 스타일 (그림체, 색감, 비율, 조명) / 배경 스타일 (장소, 색상, 텍스처) 별도 관리
- **발행물에서 추출**: 기존 인스타툰 이미지 업로드 → Vision AI가 인물/배경 스타일 자동 분석
- **직접 업로드**: 참고 이미지를 올려서 인물 or 배경 스타일로 선택하여 저장
- **조합 선택**: 저장된 인물 스타일 + 배경 스타일을 조합하여 이미지 생성에 적용
- **샘플 미리보기**: 전체 생성 전 1장 Low 품질 샘플로 확인 (API 비용 절약)
- **수동 프롬프트 편집**: 샘플 불만족 시 프롬프트 직접 수정하여 기준 이미지 변경

스타일 vs 캐릭터 구분:
- **스타일** = "어떤 그림체로 그릴 것인가" (선 굵기, 색감, 조명 등)
- **캐릭터** = "누가 등장하는가" (얼굴, 머리, 의상 등)

> 상세: STYLE_SYSTEM.md 참조
```

(기존 §4.3 콘텐츠 밀도 규칙 → §4.4로 번호 변경, 이하 순서 밀림)

#### ➕ §6 상세 설정에 추가: 캡션 자동 생성 구조

현재 §6 "상세 설정" 테이블 아래에 추가:

```markdown
### 6.1 캡션 자동 생성 구조

캡션은 4파트로 구성:

```
🔥 훅 문장 (1~2줄)
— 스크롤 멈추게 하는 첫 문장
— 예: "남편이 갑자기 개발자가 되겠다고 선언했다"

📝 본문 캡션 (3~5줄)  
— 웹툰 내용 요약 + 핵심 정보
— 전문 용어는 쉽게 풀어서 설명

💡 전문가 팁 (1~2줄)
— 실제로 도움 되는 실무 팁
— 예: "종합소득세 신고는 5월 1일~31일, 홈택스에서 가능합니다"

#️⃣ 해시태그 (15~20개)
— 대분류(3~5개) + 중분류(5~7개) + 소분류(5~8개)
— 예: #세무 #종합소득세 #세금신고 #홈택스 #프리랜서세금 ...
```

| 파트 | 글자 수 | 규칙 |
|------|---------|------|
| 훅 | 30~50자 | 궁금증/공감 유발, 이모지 1~2개 |
| 본문 | 100~200자 | 줄바꿈으로 가독성, 핵심만 |
| 팁 | 50~80자 | 실용적, 구체적 |
| 해시태그 | 15~20개 | 관련성 높은 것만 |
```

#### ➕ 새 섹션 추가: 제약사항 및 한계

§8 "로컬 저장소 구조" 뒤에 추가:

```markdown
## 9. 제약사항 및 한계

### 9.1 기술적 제약

| 항목 | 제약 | 대응 |
|------|------|------|
| 한글 텍스트 | AI 모델 한글 렌더링 불가 | Pillow 후처리 오버레이 |
| 캐릭터 일관성 | 100% 동일 불가 (80~90% 목표) | DNA Template + 레퍼런스 + LOCKED |
| 이미지 생성 속도 | 장당 5~30초 | 비동기 처리 + 진행바 |
| 인스타 API | 캐러셀 최대 10장 | 시리즈 자동 분할 |

### 9.2 비용 구조 (사용자 부담)

| 서비스 | 무료 범위 | 유료 시 |
|--------|----------|---------|
| Gemini Flash | 무료 티어 넉넉 | $0.001/1K 토큰 |
| GPT Image 1 Mini | 없음 | $0.005~/장 |
| Cloudinary | 월 25GB | 초과 시 과금 |
| Instagram API | 무료 | 무료 |

## 10. 향후 확장 계획

### Phase 1 (현재)
- 기본 워크플로우 완성 (키워드 → 웹툰 → 발행)
- 5개 이미지 모델 지원
- 캐릭터 일관성 시스템

### Phase 2
- SaaS 전환 검토
- 다국어 지원 (영어, 일본어)
- 추가 이미지 모델 (Hunyuan, Flux)
- 팀 협업 기능

### Phase 3 (선택적)
- 동영상 변환 (Kling, Sora 등)
- 다른 플랫폼 발행 (유튜브 쇼츠, 틱톡)
- 사용자 커뮤니티/마켓플레이스

## 11. 참고 자료

### 11.1 영감 받은 서비스
- 캡틴AI 블로그 (이미지 생성 + SNS 발행 자동화 사례)

### 11.2 캡틴AI 참고하여 반영된 기능

| 기능 | 캡틴AI | 우리 시스템 |
|------|--------|------------|
| 그림 스타일 선택 | ✅ | ✅ + 세부 스타일 4종 |
| 저장 포맷 옵션 | ✅ | ✅ 개별/합본/ZIP |
| 대사 배치 선택 | ✅ | ✅ 말풍선/자막 |
| 캐릭터 프로필 | 기본 | ✅ DNA Template + 시트 |
| 단계별 이동 | ✅ | ✅ 이전/다음 |
| AI 모델 선택 | 제한적 | ✅ 5개 모델 + 품질 옵션 |
| 캡션 자동 생성 | ❌ | ✅ 4파트 구조 |
| 인스타 발행 | ❌ | ✅ Graph API 직접 |
```

#### ➕ 워크플로우 업데이트

현재 §3의 워크플로우 플로우차트를 아래로 교체:

```markdown
```
[키워드 입력] → [분야 자동 감지] → [정보 수집] → [스토리 생성]
      ↓
[씬 검토 UI] ← 1차 체크포인트 (씬별 편집/재생성)
      ↓
[캐릭터 선택] + [스타일 선택 (인물/배경)]
      ↓
[샘플 미리보기] ← 1장 Low품질 확인 (비용 절약)
      ↓
[이미지 생성]
      ↓
[이미지 편집] ← 2차 체크포인트 ⭐
  - 상단: 전체 톤 조절 (채도/밝기/색감 일괄 변경)
  - 본문: 씬별 이미지 확인/재생성/프롬프트 수정
  - 모든 씬 확정 후 다음 진행
      ↓
[텍스트 오버레이] (Pillow로 한글 말풍선 합성)
      ↓
[캡션 검토 UI] ← 3차 체크포인트 (훅/본문/팁/해시태그)
      ↓
[최종 확인] → [Instagram 발행]
```
```

#### ➕ 문서 구조에 추가

§9 "문서 구조"에 아래 2개 파일 추가:

```markdown
├── STYLE_SYSTEM.md            ← 스타일 관리 시스템 (인물/배경 스타일, 샘플 미리보기)
├── IMAGE_EDIT_STAGE.md        ← 이미지 편집 단계 (전체 톤 조절, 씬별 편집)
```

#### ➕ 변경 이력 추가

```markdown
| 2026-02-09 | 1.4.0 | 스타일 관리 시스템 추가, 이미지 편집 단계 추가, 누락된 원본 내용 복원 (자동/수동 모드, 씬 검토 UI, 캐릭터 프리셋/표정, 캡션 구조, 제약사항, 확장 계획, 참고 자료) |
```

---

## 작업 3: DECISION_LOG.md에 추가

기존 DEC-019 아래, "향후 결정 필요 사항" 위에 아래 2개를 추가:

```markdown
---

### DEC-020: 스타일 관리 시스템 ⭐⭐

**결정**: 인물 스타일 / 배경 스타일을 별도로 저장·관리하는 시스템 구축

**핵심 기능들**:
1. **스타일 저장 분리**: 인물 스타일(그림체)과 배경 스타일(장소/분위기) 별도 관리
2. **발행물에서 추출**: 기존 인스타툰 업로드 → Vision AI 자동 분석 → 스타일 저장
3. **직접 업로드**: 참고 이미지 → 인물 or 배경 선택하여 스타일 저장
4. **조합 선택**: 인물 스타일 + 배경 스타일 조합하여 이미지 생성
5. **샘플 미리보기**: 전체 생성 전 1장 Low 품질로 확인 (API 비용 절약)
6. **수동 프롬프트 편집**: 샘플 불만족 시 프롬프트 직접 수정

**스타일 vs 캐릭터 구분**:
- 스타일 = "어떤 그림체로?" (선 굵기, 색감, 비율, 조명)
- 캐릭터 = "누가 등장?" (얼굴, 머리, 의상) → CHARACTER_CONSISTENCY.md

**이유**:
- 같은 계정의 웹툰은 주제가 달라도 그림체가 통일되어야 브랜딩 효과
- 기존 발행물이 있으면 새 콘텐츠도 동일 스타일 필요
- 미리보기로 비용 낭비 방지 (Low 품질 1장 ~$0.003)
- 수동 편집으로 세밀한 제어 가능

> 상세: STYLE_SYSTEM.md

---

### DEC-021: 이미지 편집 단계 신설 ⭐⭐

**결정**: 이미지 생성과 텍스트 오버레이 사이에 "이미지 편집" 단계 추가

**기존**: 이미지 생성 → 이미지 검토(확정/재생성) → 텍스트 오버레이
**변경**: 이미지 생성 → **이미지 편집** → 텍스트 오버레이

**편집 단계 핵심 기능**:
1. **전체 톤 조절 (상단)**: 자연어 명령으로 전체 씬 색감/채도/밝기 일괄 변경
   - 단순 보정(채도, 밝기 등) → Pillow로 무료 처리
   - 복잡한 변경(배경 교체, 구도 변경) → AI 재생성 (비용 안내)
2. **씬별 편집 카드**: 왼쪽 씬 정보 + 오른쪽 이미지, 개별 재생성/프롬프트 수정/업로드/확정
3. **프롬프트 수정 모달**: 스타일/캐릭터 블록은 읽기전용(일관성 보호), 씬 설명만 편집 가능
4. **모든 씬 확정** 후 다음 단계 진행

**텍스트 오버레이 전에 편집하는 이유**:
- 말풍선 합성 후 이미지를 바꾸면 위치/크기 재조정 필요
- 원본(글자 없는 깨끗한 이미지) 상태에서 확정하는 게 효율적
- 대사 수정은 텍스트 오버레이 단계에서 무료로 가능

> 상세: IMAGE_EDIT_STAGE.md
```

그리고 "향후 결정 필요 사항" 테이블에 아래 행 추가:

```markdown
| 스타일 자동 추출 정확도 개선 | 검토 | 사용자 피드백 후 |
```

변경 이력 테이블에 추가:

```markdown
| 2026-02-09 | DEC-020~021 | 스타일 관리 시스템, 이미지 편집 단계 |
```

---

## 작업 4: UI_SPEC.md 업데이트

### 4-1. 프로그레스 바 업데이트

§1 전체 UI 구조에서 프로그레스 바를 아래로 교체:

```
│  ① 시작 → ② 정보 → ③ 스토리 → ④ 스타일 → ⑤ 이미지생성  │
│  → ⑥ 이미지편집 → ⑦ 텍스트 → ⑧ 캡션 → ⑨ 발행           │
```

### 4-2. §2.3 이미지 검토를 이미지 편집으로 변경

```markdown
### 2.3 이미지 편집 UI (2차 체크포인트) ⭐

이미지 생성 후 ~ 텍스트 오버레이 전. 깨끗한 이미지 상태에서 확정.

**상단: 전체 톤 조절**
- 자연어 명령 입력: "좀 더 채도를 높여줘", "따뜻한 느낌으로"
- 빠른 버튼: [채도↑] [채도↓] [밝기↑] [밝기↓] [따뜻하게] [차갑게] [선명하게] [부드럽게] [대비↑] [대비↓]
- 단순 색감 → Pillow 무료 처리 / 복잡한 변경 → AI 재생성 (비용 안내)
- [전체 적용] [전체 원복]

**본문: 씬별 편집 카드**
- 왼쪽: 나레이션, 대사, 이미지 프롬프트, 생성 시간
- 오른쪽: 생성된 이미지 미리보기 (말풍선 없는 원본)
- 하단: [이미지 재생성] [프롬프트 수정] [이미지 업로드] [✓ 확정]

**프롬프트 수정 모달**
- 스타일 블록: 읽기전용 🔒 (일관성 보호)
- 캐릭터 블록: 읽기전용 🔒
- 씬 설명: 편집 가능 ✏️
- 추가 지시사항: 편집 가능 ✏️
- [미리보기 (Low)] [재생성] [취소]

**진행 상태**: 모든 씬 ✓ 확정 시 다음 단계 진행 가능

> 상세: IMAGE_EDIT_STAGE.md 참조
```

### 4-3. 변경 이력 추가

```markdown
| 2026-02-09 | 3.0.0 | 이미지 편집 UI 추가 (전체 톤 조절 + 씬별 편집 카드 + 프롬프트 수정 모달), 프로그레스 바 9단계 확장 |
```

---

## 작업 5: 확인 체크리스트

모든 작업이 끝나면 아래를 확인해주세요:

- [ ] STYLE_SYSTEM.md 파일이 추가되었는가?
- [ ] IMAGE_EDIT_STAGE.md 파일이 추가되었는가?
- [ ] PRD_MASTER.md에 자동/수동 모드 상세 설명이 있는가?
- [ ] PRD_MASTER.md에 씬 검토 UI ASCII 다이어그램이 있는가?
- [ ] PRD_MASTER.md에 캐릭터 프리셋 저장/불러오기가 있는가?
- [ ] PRD_MASTER.md에 캐릭터 표정 지정 (자동/수동)이 있는가?
- [ ] PRD_MASTER.md에 캡션 4파트 구조 (훅/본문/팁/해시태그)가 있는가?
- [ ] PRD_MASTER.md에 스타일 관리 시스템 섹션이 있는가?
- [ ] PRD_MASTER.md에 제약사항 및 한계 섹션이 있는가?
- [ ] PRD_MASTER.md에 향후 확장 계획 Phase 1/2/3이 있는가?
- [ ] PRD_MASTER.md에 캡틴AI 참고 자료가 있는가?
- [ ] PRD_MASTER.md 워크플로우에 스타일 선택 + 이미지 편집 단계가 있는가?
- [ ] PRD_MASTER.md 문서 구조에 STYLE_SYSTEM.md, IMAGE_EDIT_STAGE.md가 있는가?
- [ ] DECISION_LOG.md에 DEC-020, DEC-021이 추가되었는가?
- [ ] UI_SPEC.md에 이미지 편집 UI가 있는가?
- [ ] 기존에 있던 내용이 삭제되지 않았는가?
