# ìºë¦­í„° LoRA ìë™ í•™ìŠµ ê¸°ëŠ¥ â€” ê¸°ìˆ  ëª…ì„¸ì„œ

> **ë¬¸ì„œ ëª©ì **: ì½”ë”© AI(Cursor ë“±)ê°€ ì´ ê¸°ëŠ¥ì„ ì •í™•í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡, ëª¨ë“  ìš”êµ¬ì‚¬í•­Â·ì›Œí¬í”Œë¡œìš°Â·APIÂ·ë°ì´í„°êµ¬ì¡°Â·UI ë™ì‘ì„ ë¹ ì§ì—†ì´ ê¸°ìˆ í•œë‹¤.
> **ì‘ì„±ì¼**: 2026-02-13
> **ëŒ€ìƒ í”„ë¡œì íŠ¸**: í•œêµ­ ì„¸ê¸ˆ ì›¹íˆ° ìë™ ìƒì„± í”„ë¡œê·¸ë¨ (FastAPI ë°±ì—”ë“œ)

---

## 1. ê¸°ëŠ¥ ê°œìš”

### 1.1 í•µì‹¬ ì»¨ì…‰
ì‚¬ìš©ìê°€ **ì‚¬ì§„ 1ì¥ë§Œ ì—…ë¡œë“œ**í•˜ë©´, ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ:
1. 24ì»· ì´ìƒì˜ ë‹¤ì–‘í•œ í‘œì •Â·í¬ì¦ˆ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³ 
2. ì‚¬ìš©ìê°€ ì„ ë³„í•œ ì´ë¯¸ì§€ë¡œ LoRA í•™ìŠµì„ ì‹¤í–‰í•˜ê³ 
3. í•™ìŠµ ì™„ë£Œëœ ìºë¦­í„°ë¥¼ ì €ì¥í•˜ì—¬ ì´í›„ ì›¹íˆ° ì œì‘ì— ìë™ ì ìš©í•œë‹¤.

### 1.2 ì°¨ë³„ì 
- ë‹¤ë¥¸ ì›¹íˆ° ìë™í™” ë„êµ¬: "í”„ë¡¬í”„íŠ¸ë¡œ ì•Œì•„ì„œ ì¼ê´€ì„± ë§ì¶°ë´" â†’ ì¼ê´€ì„± 60~70%
- **ìš°ë¦¬ í”„ë¡œê·¸ë¨**: "ì‚¬ì§„ í•œ ì¥ì´ë©´ ë" â†’ LoRA í•™ìŠµìœ¼ë¡œ ì¼ê´€ì„± 95%+

### 1.3 ì´ ê¸°ëŠ¥ì´ í•„ìš”í•œ ì´ìœ 
í˜„ì¬ ì„¤ê³„ëŠ” "í”„ë¡¬í”„íŠ¸ ê³ ì • + ë ˆí¼ëŸ°ìŠ¤ ì´ë¯¸ì§€ ì²¨ë¶€" ë°©ì‹ì¸ë°, ì´ê²ƒë§Œìœ¼ë¡œëŠ”:
- ì•ˆê²½ í”„ë ˆì„ ëª¨ì–‘ì´ ì”¬ë§ˆë‹¤ ë‹¬ë¼ì§
- ì„  êµµê¸°ê°€ ë¯¸ë¬˜í•˜ê²Œ ë³€í•¨
- ì˜· ìƒ‰ìƒì´ ì•½ê°„ì”© ë°”ë€œ (navy â†’ dark blue â†’ black)
- ë¨¸ë¦¬ ê¸¸ì´/ìŠ¤íƒ€ì¼ì´ í”ë“¤ë¦¼
- 2ì¸ ë“±ì¥ ì‹œ ìºë¦­í„°ê°€ ë’¤ë°”ë€œ

**í•µì‹¬ ì›ì¸**: GPT Image, Nano Banana ë“±ì€ ë²”ìš© ëª¨ë¸ì´ë¼ "ì´ ìºë¦­í„°"ë¥¼ ì§„ì§œë¡œ í•™ìŠµí•œ ê²Œ ì•„ë‹˜. ë§¤ë²ˆ í”„ë¡¬í”„íŠ¸ë¥¼ í•´ì„í•´ì„œ ìƒˆë¡œ ê·¸ë¦¬ëŠ” ê²ƒ. LoRAëŠ” ëª¨ë¸ ìì²´ì— ìºë¦­í„°ë¥¼ í•™ìŠµì‹œí‚¤ë¯€ë¡œ ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°ë¨.

---

## 2. ì „ì²´ ì›Œí¬í”Œë¡œìš° (ë‹¨ê³„ë³„ ìƒì„¸)

```
[Step 1] ì‚¬ì§„ 1ì¥ ì—…ë¡œë“œ
    â†“
[Step 2] ìŠ¤íƒ€ì¼ ì„ íƒ (6ê°€ì§€ ì˜µì…˜)
    â†“
[Step 3] 24ì»· ìë™ ìƒì„± (~$0.50, 2~3ë¶„)
    â†“
[Step 4] ë¯¸ë¦¬ë³´ê¸° + ì„ ë³„ (ì‚¬ìš©ìê°€ ì²´í¬ë°•ìŠ¤ë¡œ ì„ íƒ)
    â†“
[Step 5] ìë™ ë¶„í•  + ZIP íŒ¨í‚¤ì§•
    â†“
[Step 6] LoRA í•™ìŠµ ì‹¤í–‰ (~$2, 15~30ë¶„, ë°±ê·¸ë¼ìš´ë“œ)
    â†“
[Step 7] ì™„ë£Œ ì•Œë¦¼ + í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìë™ ìƒì„±
    â†“
[Step 8] ë‚´ ìºë¦­í„° íƒ­ì— ìë™ ì €ì¥
    â†“
[ì´í›„] ì›¹íˆ° ì œì‘ ì‹œ ìºë¦­í„° ì„ íƒí•˜ë©´ ìë™ ì ìš©
```

---

## 3. ê° Step ìƒì„¸ êµ¬í˜„ ëª…ì„¸

### Step 1: ì‚¬ì§„ ì—…ë¡œë“œ

**ì…ë ¥**: ì‚¬ìš©ìê°€ ìºë¦­í„°ë¡œ ë§Œë“¤ ì‚¬ì§„ 1ì¥ ì—…ë¡œë“œ
- ì§€ì› í¬ë§·: JPG, PNG, WEBP
- ìµœì†Œ í•´ìƒë„: 512Ã—512 ê¶Œì¥ (ê·¸ ì´í•˜ë„ ê°€ëŠ¥í•˜ë‚˜ í’ˆì§ˆ ì €í•˜)
- ìµœëŒ€ íŒŒì¼ í¬ê¸°: 10MB

**ì²˜ë¦¬**:
- ì—…ë¡œë“œëœ ì´ë¯¸ì§€ë¥¼ ì„ì‹œ ì €ì¥
- ì´ë¯¸ì§€ ìœ íš¨ì„± ê²€ì‚¬ (í¬ë§·, í¬ê¸°, í•´ìƒë„)
- ì–¼êµ´ ê°ì§€ í™•ì¸ (ì„ íƒì‚¬í•­ â€” ì–¼êµ´ì´ ì—†ëŠ” ìºë¦­í„°ë„ í—ˆìš©í•˜ë˜ ê²½ê³  í‘œì‹œ)

**API ì—”ë“œí¬ì¸íŠ¸**:
```
POST /api/character/upload-photo
Request: multipart/form-data { photo: File }
Response: {
  "photo_id": "uuid",
  "photo_url": "ì„ì‹œ ì €ì¥ URL",
  "resolution": "1024x1024",
  "face_detected": true
}
```

---

### Step 2: ìŠ¤íƒ€ì¼ ì„ íƒ

**UI**: ì‚¬ì§„ ì—…ë¡œë“œ ì§í›„, 24ì»· ìƒì„± ì „ì— ë³€í™˜ ìŠ¤íƒ€ì¼ì„ ì„ íƒí•˜ëŠ” í™”ë©´ì„ í‘œì‹œí•œë‹¤.

**ìŠ¤íƒ€ì¼ ì˜µì…˜ (ì´ 6ê°€ì§€)**:

| ìˆœì„œ | ìŠ¤íƒ€ì¼ ID | ì´ë¦„ | ì„¤ëª… | í”„ë¡¬í”„íŠ¸ í‚¤ì›Œë“œ |
|------|-----------|------|------|----------------|
| 0 | `original` | **ğŸ“· ì›ë³¸ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ** | ì—…ë¡œë“œí•œ ì‚¬ì§„ì˜ ìŠ¤íƒ€ì¼ì„ ìµœëŒ€í•œ ìœ ì§€í•˜ë©´ì„œ í‘œì •/í¬ì¦ˆë§Œ ë³€ê²½. ì‚¬ì§„ì´ ì‹¤ì‚¬ë©´ ì‹¤ì‚¬ë¡œ, ê·¸ë¦¼ì´ë©´ ê·¸ë¦¼ìœ¼ë¡œ ìƒì„±. | `same style as the reference photo, maintaining original art style` |
| 1 | `realistic_sketch` | ğŸ¨ ì‹¤ì‚¬ ì–¼êµ´ + ì†ê·¸ë¦¼ ëª¸ì²´ | ì‹¤ì‚¬ ëŠë‚Œì˜ ì–¼êµ´ì— ì‰í¬ ìŠ¤ì¼€ì¹˜ ìŠ¤íƒ€ì¼ ëª¸ì²´. ì¹´ì¹´ì˜¤í†¡ ì´ëª¨í‹°ì½˜ ê°ì„±. | `realistic face with hand-drawn ink sketch body, simple stick figure body, white background` |
| 2 | `chibi_2head` | ğŸ§¸ 2ë“±ì‹  ì¹˜ë¹„ | ë¨¸ë¦¬ê°€ ëª¸ì˜ ì ˆë°˜ì¸ ê·€ì—¬ìš´ 2ë“±ì‹  ìºë¦­í„°. | `chibi style, 2-head tall proportion, cute large head, small body, simple colored` |
| 3 | `kakao_emoticon` | ğŸ’¬ ì¹´ì¹´ì˜¤ ì´ëª¨í‹°ì½˜í’ | ì¹´ì¹´ì˜¤í†¡ ì´ëª¨í‹°ì½˜ ìŠ¤íƒ€ì¼. ë‘¥ê¸€ë‘¥ê¸€í•œ ë¼ì¸, ë°ì€ ìƒ‰ê°. | `Korean KakaoTalk emoticon style, round soft lines, bright pastel colors, cute expression` |
| 4 | `simple_lineart` | âœï¸ ë‹¨ìˆœ ì„ í™” | ìµœì†Œí•œì˜ í‘ë°± ì„ í™”. ê¹”ë”í•œ ì•„ì›ƒë¼ì¸ë§Œ. | `minimal black line art, clean outline, no shading, white background, monochrome` |
| 5 | `custom` | ğŸ”§ ì»¤ìŠ¤í…€ | ì‚¬ìš©ìê°€ ì§ì ‘ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥. | (ì‚¬ìš©ì ì…ë ¥) |

**âš ï¸ ì¤‘ìš”: "ì›ë³¸ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ" ì˜µì…˜ (ìˆœì„œ 0)**
- ì´ ì˜µì…˜ì´ **ë””í´íŠ¸(ê¸°ë³¸ê°’)**ìœ¼ë¡œ ì„ íƒë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.
- ë™ì‘ ì›ë¦¬: ì—…ë¡œë“œëœ ì‚¬ì§„ì„ Flux Kontextì˜ ì´ë¯¸ì§€-to-ì´ë¯¸ì§€ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬, ì›ë³¸ ì‚¬ì§„ì˜ í™”í’Â·ìƒ‰ê°Â·ì§ˆê°ì„ ìµœëŒ€í•œ ë³´ì¡´í•˜ë©´ì„œ í‘œì •ê³¼ í¬ì¦ˆë§Œ ë‹¤ì–‘í•˜ê²Œ ë³€í™˜í•œë‹¤.
- ì‹¤ì‚¬ ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ â†’ ì‹¤ì‚¬ ìŠ¤íƒ€ì¼ë¡œ 24ì»· ìƒì„±
- ê·¸ë¦¼/ì¼ëŸ¬ìŠ¤íŠ¸ë¥¼ ì˜¬ë¦¬ë©´ â†’ í•´ë‹¹ ê·¸ë¦¼ì²´ë¡œ 24ì»· ìƒì„±
- ì´ë¯¸ ìºë¦­í„° ì‹œíŠ¸ë‚˜ ì´ëª¨í‹°ì½˜ ì´ë¯¸ì§€ë¥¼ ì˜¬ë¦¬ëŠ” ê²½ìš° â†’ ê·¸ ìŠ¤íƒ€ì¼ ìœ ì§€
- ê¸°ìˆ ì  ì°¨ì´: `original` ìŠ¤íƒ€ì¼ì€ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ë“¤ê³¼ ë‹¬ë¦¬ ìŠ¤íƒ€ì¼ ë³€í™˜ í”„ë¡¬í”„íŠ¸ë¥¼ ì¶”ê°€í•˜ì§€ ì•Šê³ , ìˆœìˆ˜í•˜ê²Œ "same person/character, different pose/expression" ê³„ì—´ í”„ë¡¬í”„íŠ¸ë§Œ ì‚¬ìš©í•œë‹¤.

**ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ì…ë ¥ UI**:
- `custom` ì„ íƒ ì‹œ í…ìŠ¤íŠ¸ ì…ë ¥ë€ì´ ë‚˜íƒ€ë‚¨
- í”Œë ˆì´ìŠ¤í™€ë”: "ì›í•˜ëŠ” ìŠ¤íƒ€ì¼ì„ ì„¤ëª…í•´ì£¼ì„¸ìš” (ì˜ˆ: ì§€ë¸Œë¦¬í’ ìˆ˜ì±„í™”, í”½ì‚¬ 3D ìŠ¤íƒ€ì¼...)"
- ìµœëŒ€ 200ì

**API ì—”ë“œí¬ì¸íŠ¸**:
```
POST /api/character/select-style
Request: {
  "photo_id": "uuid",
  "style_id": "realistic_sketch",  // ê¸°ë³¸ê°’: "original"
  "custom_prompt": null  // style_idê°€ "custom"ì¼ ë•Œë§Œ ì‚¬ìš©
}
Response: {
  "session_id": "uuid",
  "selected_style": "realistic_sketch",
  "estimated_cost": 0.50,
  "estimated_time_seconds": 180
}
```

---

### Step 3: 24ì»· ìë™ ìƒì„±

**ëª©ì **: LoRA í•™ìŠµì— í•„ìš”í•œ ë‹¤ì–‘í•œ í‘œì •Â·í¬ì¦ˆÂ·ê°ë„ ì´ë¯¸ì§€ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•œë‹¤.

**ìƒì„±í•  24ì»·ì˜ êµ¬ì„±**:

ì´ 24ì»·ì„ ì•„ë˜ ì¹´í…Œê³ ë¦¬ë¡œ ë‚˜ëˆ„ì–´ ìƒì„±í•œë‹¤. ê° ì¹´í…Œê³ ë¦¬ì— í•´ë‹¹í•˜ëŠ” í”„ë¡¬í”„íŠ¸ ë³€í˜•ì„ ìë™ìœ¼ë¡œ ì¡°í•©í•œë‹¤.

```
[í‘œì • 8ì»·]
1. ì •ë©´ ë¯¸ì†Œ (neutral smile, front view)
2. í™œì§ ì›ƒìŒ (big laugh, slightly tilted head)
3. ë†€ëŒ (surprised, wide eyes, open mouth)
4. í™”ë‚¨ (angry, furrowed brows)
5. ìŠ¬í”” (sad, downcast eyes)
6. ë‹¹í™© (embarrassed, sweating)
7. ìì‹ ê° (confident, smirk)
8. ìƒê° ì¤‘ (thinking, hand on chin)

[ê°ë„ 4ì»·]
9. ì¢Œì¸¡ 45ë„ (3/4 view from left)
10. ìš°ì¸¡ 45ë„ (3/4 view from right)
11. ì¢Œì¸¡ í”„ë¡œí•„ (left profile)
12. ìš°ì¸¡ í”„ë¡œí•„ (right profile)

[ìƒë°˜ì‹  í¬ì¦ˆ 6ì»·]
13. íŒ”ì§± (arms crossed)
14. ì† í”ë“¤ê¸° (waving hand)
15. ì–‘ì† ìœ„ë¡œ (both hands raised, celebrating)
16. í•œ ì† ê°€ë¦¬í‚¤ê¸° (pointing with one hand)
17. ì—„ì§€ ì²™ (thumbs up)
18. ì„¤ëª…í•˜ëŠ” í¬ì¦ˆ (explaining gesture, one hand open)

[ì „ì‹  í¬ì¦ˆ 4ì»·]
19. ì„œìˆëŠ” ì •ë©´ (standing front)
20. ê±·ëŠ” í¬ì¦ˆ (walking pose)
21. ì•‰ì€ í¬ì¦ˆ (sitting pose)
22. ë’¤ëŒì•„ë³´ê¸° (looking back over shoulder)

[ì”¬ ë§¥ë½ 2ì»·]
23. ì‚¬ë¬´ì‹¤ ë°°ê²½ì—ì„œ (in office setting)
24. ì±…ìƒ ì•ì—ì„œ (at desk with documents)
```

**í”„ë¡¬í”„íŠ¸ ì¡°í•© ë¡œì§**:

```python
def build_generation_prompt(style_id: str, pose_prompt: str, custom_prompt: str = None) -> str:
    """
    24ì»· ê°ê°ì— ëŒ€í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•œë‹¤.
    
    Args:
        style_id: ì„ íƒëœ ìŠ¤íƒ€ì¼ ("original", "realistic_sketch", "chibi_2head", ...)
        pose_prompt: 24ì»· ì¤‘ í•´ë‹¹ ì»·ì˜ í¬ì¦ˆ/í‘œì • ì„¤ëª… (ì˜ì–´)
        custom_prompt: style_idê°€ "custom"ì¼ ë•Œ ì‚¬ìš©ì ì…ë ¥ ìŠ¤íƒ€ì¼
    
    Returns:
        ì™„ì„±ëœ í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´
    """
    
    STYLE_PROMPTS = {
        "original": "",  # ìŠ¤íƒ€ì¼ ë³€í™˜ ì—†ìŒ â€” ì›ë³¸ ìœ ì§€
        "realistic_sketch": "realistic face with hand-drawn ink sketch body, simple stick figure body, white background",
        "chibi_2head": "chibi style, 2-head tall proportion, cute large head, small body, simple colored, white background",
        "kakao_emoticon": "Korean KakaoTalk emoticon style, round soft lines, bright pastel colors, cute expression, white background",
        "simple_lineart": "minimal black line art, clean outline, no shading, white background, monochrome",
        "custom": custom_prompt or ""
    }
    
    style_part = STYLE_PROMPTS.get(style_id, "")
    
    if style_id == "original":
        # ì›ë³¸ ìŠ¤íƒ€ì¼: ìŠ¤íƒ€ì¼ ë³€í™˜ í”„ë¡¬í”„íŠ¸ ì—†ì´ í¬ì¦ˆ/í‘œì •ë§Œ ì§€ì‹œ
        prompt = f"same person, same style as the input image, {pose_prompt}, clean background"
    else:
        # ìŠ¤íƒ€ì¼ ë³€í™˜: ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ + í¬ì¦ˆ/í‘œì •
        prompt = f"{style_part}, {pose_prompt}"
    
    return prompt
```

**ì´ë¯¸ì§€ ìƒì„± ë°©ì‹ â€” 2ê°€ì§€ ê²½ë¡œ**:

ê²½ë¡œ A: `original` ìŠ¤íƒ€ì¼ ì„ íƒ ì‹œ
- **Flux Kontext (ì´ë¯¸ì§€â†’ì´ë¯¸ì§€)** ì‚¬ìš©
- ì—…ë¡œë“œí•œ ì›ë³¸ ì‚¬ì§„ì„ input_imageë¡œ ë„£ê³ , í¬ì¦ˆ/í‘œì • ë³€ê²½ í”„ë¡¬í”„íŠ¸ë§Œ ì „ë‹¬
- ì›ë³¸ ìŠ¤íƒ€ì¼ì´ ìì—°ìŠ¤ëŸ½ê²Œ ìœ ì§€ë¨
- API: `fal-ai/flux-kontext`

```python
# original ìŠ¤íƒ€ì¼: Flux Kontext ì‚¬ìš©
result = fal_client.subscribe("fal-ai/flux-kontext", arguments={
    "prompt": "same person, different expression: big laugh, slightly tilted head, clean background",
    "image_url": uploaded_photo_url,  # ì›ë³¸ ì‚¬ì§„
})
```

ê²½ë¡œ B: ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ ì„ íƒ ì‹œ (`realistic_sketch`, `chibi_2head`, `kakao_emoticon`, `simple_lineart`, `custom`)
- **GPT Image ë˜ëŠ” Flux 2** ì‚¬ìš© (ê¸°ì¡´ ì´ë¯¸ì§€ ìƒì„± íŒŒì´í”„ë¼ì¸)
- ì›ë³¸ ì‚¬ì§„ì„ ë ˆí¼ëŸ°ìŠ¤ë¡œ ì²¨ë¶€ + ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ + í¬ì¦ˆ í”„ë¡¬í”„íŠ¸ ì¡°í•©
- ìŠ¤íƒ€ì¼ ë³€í™˜ì´ ì ìš©ë¨

```python
# ìŠ¤íƒ€ì¼ ë³€í™˜: ê¸°ì¡´ ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸ ì‚¬ìš©
result = generate_image(
    prompt=build_generation_prompt("realistic_sketch", "big laugh, slightly tilted head"),
    reference_image=uploaded_photo_url,  # ë ˆí¼ëŸ°ìŠ¤ë¡œ ì²¨ë¶€
    model="gpt-image"  # ë˜ëŠ” ë‹¤ë¥¸ ëª¨ë¸
)
```

**ìƒì„± ê²°ê³¼**:
- 24ì¥ì˜ ì´ë¯¸ì§€ê°€ í•˜ë‚˜ì˜ ê·¸ë¦¬ë“œ(ì‹œíŠ¸)ê°€ ì•„ë‹Œ, **ê°œë³„ ì´ë¯¸ì§€**ë¡œ ìƒì„±ëœë‹¤.
- ê° ì´ë¯¸ì§€ì˜ í•´ìƒë„: 1024Ã—1024 (ì •ì‚¬ê°í˜•)
- ë°°ê²½: ê°€ëŠ¥í•˜ë©´ ê¹¨ë—í•œ í° ë°°ê²½ (LoRA í•™ìŠµì— ìœ ë¦¬)

**ë¹„ìš©**: ì´ë¯¸ì§€ 1ì¥ë‹¹ ~$0.02 Ã— 24ì¥ = ~$0.50

**API ì—”ë“œí¬ì¸íŠ¸**:
```
POST /api/character/generate-24-cuts
Request: {
  "session_id": "uuid"
}
Response: {
  "task_id": "uuid",
  "status": "generating",
  "total_cuts": 24,
  "estimated_time_seconds": 180
}

# ì§„í–‰ ìƒíƒœ í™•ì¸ (polling ë˜ëŠ” WebSocket)
GET /api/character/generation-status/{task_id}
Response: {
  "status": "generating",  // "generating" | "completed" | "failed"
  "completed_cuts": 15,
  "total_cuts": 24,
  "preview_urls": ["url1", "url2", ...]  // ì™„ë£Œëœ ê²ƒë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ì±„ì›Œì§
}
```

---

### Step 4: ë¯¸ë¦¬ë³´ê¸° + ì„ ë³„

**ëª©ì **: ìƒì„±ëœ 24ì»· ì¤‘ í’ˆì§ˆì´ ì¢‹ì€ ê²ƒë§Œ ì„ íƒí•˜ì—¬ LoRA í•™ìŠµ ë°ì´í„°ë¡œ ì‚¬ìš©í•œë‹¤. í’ˆì§ˆì´ ë‚˜ìœ ì´ë¯¸ì§€ê°€ í•™ìŠµì— í¬í•¨ë˜ë©´ ê²°ê³¼ë¬¼ í’ˆì§ˆì´ ë–¨ì–´ì§€ë¯€ë¡œ, ì´ ë‹¨ê³„ê°€ ì¤‘ìš”í•˜ë‹¤.

**UI êµ¬ì„±**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìºë¦­í„° í•™ìŠµ ì´ë¯¸ì§€ ì„ ë³„                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  âœ… ì„ íƒ: 20/24ì¥  (ìµœì†Œ 15ì¥ ì´ìƒ í•„ìš”)              â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ â˜‘ 1  â”‚ â”‚ â˜‘ 2  â”‚ â”‚ â˜‘ 3  â”‚ â”‚ â˜ 4  â”‚            â”‚
â”‚  â”‚[img1] â”‚ â”‚[img2] â”‚ â”‚[img3] â”‚ â”‚[img4] â”‚            â”‚
â”‚  â”‚ì •ë©´ë¯¸ì†Œâ”‚ â”‚í™œì§ì›ƒìŒâ”‚ â”‚ë†€ëŒ   â”‚ â”‚í™”ë‚¨   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ â˜‘ 5  â”‚ â”‚ â˜‘ 6  â”‚ â”‚ â˜‘ 7  â”‚ â”‚ â˜‘ 8  â”‚            â”‚
â”‚  â”‚ ...  â”‚ â”‚ ...  â”‚ â”‚ ...  â”‚ â”‚ ...  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚  ... (6Ã—4 ê·¸ë¦¬ë“œ)                                  â”‚
â”‚                                                   â”‚
â”‚  [ì „ì²´ ì„ íƒ]  [ì „ì²´ í•´ì œ]  [ì¶”ê°€ ìƒì„± (4ì»·)]          â”‚
â”‚                                                   â”‚
â”‚  âš ï¸ ì„ íƒí•œ ì´ë¯¸ì§€ê°€ 15ì¥ ë¯¸ë§Œì´ë©´ í•™ìŠµ í’ˆì§ˆì´ ë‚®ì•„ì§ˆ ìˆ˜   â”‚
â”‚     ìˆìŠµë‹ˆë‹¤. ìµœì†Œ 15ì¥ ì´ìƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.               â”‚
â”‚                                                   â”‚
â”‚              [ë‹¤ìŒ ë‹¨ê³„: LoRA í•™ìŠµ â†’]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë™ì‘ ê·œì¹™**:
1. ê¸°ë³¸ì ìœ¼ë¡œ 24ì¥ ì „ì²´ê°€ ì²´í¬ë˜ì–´ ìˆìŒ
2. ì‚¬ìš©ìê°€ ë§ˆìŒì— ì•ˆ ë“œëŠ” ì»·ì„ í•´ì œ
3. ìµœì†Œ ì„ íƒ ìˆ˜: **15ì¥** (ë¯¸ë§Œì´ë©´ ê²½ê³  í‘œì‹œ, ì§„í–‰ì€ ê°€ëŠ¥í•˜ë‚˜ ê¶Œì¥í•˜ì§€ ì•ŠìŒ)
4. ìµœì†Œ ê¶Œì¥: **20ì¥ ì´ìƒ**
5. ì´ë¯¸ì§€ í´ë¦­ ì‹œ í™•ëŒ€ ëª¨ë‹¬ë¡œ ìƒì„¸ í™•ì¸ ê°€ëŠ¥

**ì¶”ê°€ ìƒì„± ê¸°ëŠ¥**:
- "ì¶”ê°€ ìƒì„± (4ì»·)" ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¶€ì¡±í•œ ì¹´í…Œê³ ë¦¬ì˜ ì´ë¯¸ì§€ 4ì¥ì„ ì¶”ê°€ ìƒì„±
- ì¶”ê°€ ë¹„ìš©: ~$0.08
- íŠ¹ì • ì¹´í…Œê³ ë¦¬ ì§€ì • ê°€ëŠ¥ (ì˜ˆ: "í‘œì • ì¶”ê°€", "ê°ë„ ì¶”ê°€")

**API ì—”ë“œí¬ì¸íŠ¸**:
```
POST /api/character/select-cuts
Request: {
  "session_id": "uuid",
  "selected_cut_ids": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22]
}
Response: {
  "selected_count": 20,
  "meets_minimum": true,  // 15ì¥ ì´ìƒì¸ì§€
  "estimated_training_cost": 2.00,
  "estimated_training_time_seconds": 1200
}

# ì¶”ê°€ ìƒì„±
POST /api/character/generate-additional
Request: {
  "session_id": "uuid",
  "count": 4,
  "category": "expression"  // "expression" | "angle" | "pose" | "scene" | null(ìë™)
}
```

---

### Step 5: ìë™ ë¶„í•  + ZIP íŒ¨í‚¤ì§•

**ëª©ì **: ì„ ë³„ëœ ì´ë¯¸ì§€ë“¤ì„ LoRA í•™ìŠµì— ì í•©í•œ í˜•íƒœë¡œ íŒ¨í‚¤ì§•í•œë‹¤.

**ì²˜ë¦¬ ê³¼ì •**:
1. ì„ ë³„ëœ ì´ë¯¸ì§€ë“¤ì„ 1024Ã—1024ë¡œ ë¦¬ì‚¬ì´ì¦ˆ (ì´ë¯¸ ì´ í¬ê¸°ë©´ íŒ¨ìŠ¤)
2. JPG í¬ë§·ìœ¼ë¡œ í†µì¼ (fal.ai í•™ìŠµ API ìš”êµ¬ì‚¬í•­)
3. íŒŒì¼ëª…ì„ ìˆœì°¨ì ìœ¼ë¡œ ì •ë¦¬: `01.jpg`, `02.jpg`, ...
4. ZIP íŒŒì¼ë¡œ ì••ì¶•
5. ZIP íŒŒì¼ì„ fal.aiì— ì—…ë¡œë“œí•  ìˆ˜ ìˆëŠ” URLë¡œ í˜¸ìŠ¤íŒ…

**ìº¡ì…”ë‹ (ìë™ ìº¡ì…˜ ìƒì„±)**:
- LoRA í•™ìŠµ í’ˆì§ˆì„ ë†’ì´ê¸° ìœ„í•´ ê° ì´ë¯¸ì§€ì— ëŒ€í•œ ìº¡ì…˜ í…ìŠ¤íŠ¸ë¥¼ ìë™ ìƒì„±
- ìº¡ì…˜ í¬ë§·: `{trigger_word}, {ìŠ¤íƒ€ì¼ ì„¤ëª…}, {í¬ì¦ˆ/í‘œì • ì„¤ëª…}`
- ì˜ˆ: `sks_parkboss, realistic face with hand-drawn body, smiling, front view, white background`
- ìº¡ì…˜ íŒŒì¼: ê° ì´ë¯¸ì§€ì™€ ê°™ì€ ì´ë¦„ì˜ .txt íŒŒì¼ (ì˜ˆ: `01.txt`, `02.txt`)
- ZIPì— ì´ë¯¸ì§€ì™€ ìº¡ì…˜ì„ í•¨ê»˜ í¬í•¨

**íŠ¸ë¦¬ê±° ì›Œë“œ ìƒì„± ê·œì¹™**:
- í˜•ì‹: `sks_{ìºë¦­í„°ì´ë¦„}` (ì˜ë¬¸ ì†Œë¬¸ì, ë°‘ì¤„ë§Œ ì‚¬ìš©)
- ì‚¬ìš©ìê°€ ìºë¦­í„° ì´ë¦„ì„ í•œê¸€ë¡œ ì…ë ¥í•˜ë©´ ìë™ ë¡œë§ˆì ë³€í™˜
- ì˜ˆ: "ë°•ì‚¬ì¥" â†’ `sks_parkboss`, "ê¹€ì„¸ë¬´ì‚¬" â†’ `sks_kimtax`
- ì‚¬ìš©ìê°€ ì›í•˜ë©´ íŠ¸ë¦¬ê±° ì›Œë“œë¥¼ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆìŒ

**API ì—”ë“œí¬ì¸íŠ¸**:
```
POST /api/character/prepare-training-data
Request: {
  "session_id": "uuid",
  "character_name": "ë°•ì‚¬ì¥",
  "trigger_word": null  // nullì´ë©´ ìë™ ìƒì„±, ì§ì ‘ ì…ë ¥ë„ ê°€ëŠ¥
}
Response: {
  "training_data_url": "https://storage.../training_data_parkboss.zip",
  "trigger_word": "sks_parkboss",
  "image_count": 20,
  "total_size_mb": 15.2,
  "captions_included": true
}
```

---

### Step 6: LoRA í•™ìŠµ ì‹¤í–‰

**ëª©ì **: fal.ai APIë¥¼ í†µí•´ Flux 2 ê¸°ë°˜ LoRA í•™ìŠµì„ ì‹¤í–‰í•œë‹¤.

**ì‚¬ìš© API**: `fal-ai/flux-lora-portrait-trainer` (ë˜ëŠ” ìµœì‹  ë™ê¸‰ ì—”ë“œí¬ì¸íŠ¸)

**í•™ìŠµ íŒŒë¼ë¯¸í„°**:

```python
import fal_client
import os

os.environ["FAL_KEY"] = "fal_sk_ì—¬ê¸°ì—_í‚¤_ì…ë ¥"

train_result = fal_client.subscribe(
    "fal-ai/flux-lora-portrait-trainer",
    arguments={
        "images_data_url": training_data_zip_url,  # Step 5ì—ì„œ ë§Œë“  ZIP URL
        "trigger_word": "sks_parkboss",
        "steps": 1500,              # í•™ìŠµ ìŠ¤í… ìˆ˜ (1000~2000 ë²”ìœ„, ê¸°ë³¸ 1500)
        "create_masks": True,        # ì–¼êµ´ ìë™ ë§ˆìŠ¤í‚¹ (í•™ìŠµ í’ˆì§ˆ í–¥ìƒ)
        "learning_rate": 1e-4,       # í•™ìŠµë¥  (ê¸°ë³¸ê°’ ì‚¬ìš© ê¶Œì¥)
        "resolution": 1024,          # í•™ìŠµ í•´ìƒë„
    }
)

# í•™ìŠµ ê²°ê³¼
lora_url = train_result["diffusers_lora_file"]["url"]
# ì˜ˆ: "https://fal.media/files/abc123/lora_weights.safetensors"
```

**ì¤‘ìš” ì‚¬í•­**:
- í•™ìŠµì€ **ë°±ê·¸ë¼ìš´ë“œ**ì—ì„œ ì‹¤í–‰ëœë‹¤. ì‚¬ìš©ìëŠ” í•™ìŠµ ì¤‘ì— ë‹¤ë¥¸ ì‘ì—…ì„ í•  ìˆ˜ ìˆë‹¤.
- í•™ìŠµ ì‹œê°„: 15~30ë¶„ (ì´ë¯¸ì§€ ìˆ˜ì™€ ìŠ¤í… ìˆ˜ì— ë”°ë¼ ë³€ë™)
- í•™ìŠµ ë¹„ìš©: ~$2.00
- fal.aiì˜ `subscribe` ë©”ì„œë“œëŠ” ì™„ë£Œê¹Œì§€ pollingì„ ìë™ìœ¼ë¡œ í•œë‹¤. ì„œë²„ì—ì„œëŠ” ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬.

**ì§„í–‰ ìƒíƒœ í‘œì‹œ (UI)**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ ìºë¦­í„° í•™ìŠµ ì¤‘... (ë°•ì‚¬ì¥)                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                   â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  53%             â”‚
â”‚                                                   â”‚
â”‚  â±ï¸ ì˜ˆìƒ ë‚¨ì€ ì‹œê°„: ì•½ 12ë¶„                         â”‚
â”‚  ğŸ’° ë¹„ìš©: $2.00 (â‚©2,800)                          â”‚
â”‚                                                   â”‚
â”‚  â„¹ï¸ í•™ìŠµ ì¤‘ì—ë„ ë‹¤ë¥¸ ì‘ì—…ì„ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.           â”‚
â”‚     ì™„ë£Œë˜ë©´ ì•Œë¦¼ì„ ë³´ë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.                    â”‚
â”‚                                                   â”‚
â”‚              [ë°±ê·¸ë¼ìš´ë“œë¡œ ë³´ë‚´ê¸°]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì§„í–‰ ìƒíƒœ API**:
```
GET /api/character/training-status/{task_id}
Response: {
  "status": "training",  // "preparing" | "training" | "completed" | "failed"
  "progress_percent": 53,
  "estimated_remaining_seconds": 720,
  "current_step": 795,
  "total_steps": 1500,
  "elapsed_seconds": 810
}
```

**í•™ìŠµ ì™„ë£Œ ì‹œ ì²˜ë¦¬**:
1. LoRA íŒŒì¼ URLì„ ì €ì¥
2. ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ 3ì¥ ìƒì„± (Step 7)
3. ì‚¬ìš©ìì—ê²Œ ì™„ë£Œ ì•Œë¦¼ ì „ì†¡
4. ìºë¦­í„° ë°ì´í„°ë¥¼ DBì— ì €ì¥ (Step 8)

**ì—ëŸ¬ ì²˜ë¦¬**:
- í•™ìŠµ ì‹¤íŒ¨ ì‹œ: ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ + ì¬ì‹œë„ ë²„íŠ¼ ì œê³µ
- íƒ€ì„ì•„ì›ƒ (60ë¶„ ì´ˆê³¼): ìë™ ì‹¤íŒ¨ ì²˜ë¦¬ + í™˜ë¶ˆ ì•ˆë‚´
- fal.ai ì„œë²„ ì—ëŸ¬: ìµœëŒ€ 2íšŒ ìë™ ì¬ì‹œë„

---

### Step 7: ì™„ë£Œ ì•Œë¦¼ + í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìë™ ìƒì„±

**ëª©ì **: í•™ìŠµì´ ì˜ ë˜ì—ˆëŠ”ì§€ ì‚¬ìš©ìê°€ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ë¥¼ ìë™ ìƒì„±í•œë‹¤.

**í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìƒì„±** (3ì¥):

```python
# í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìƒì„± (í•™ìŠµ ì™„ë£Œ í›„ ìë™ ì‹¤í–‰)
test_prompts = [
    f"{trigger_word}, front view, confident smile, white background",
    f"{trigger_word}, sitting at desk, explaining something, office background",
    f"{trigger_word}, full body, standing, waving hand, simple background"
]

for prompt in test_prompts:
    result = fal_client.subscribe("fal-ai/flux-lora", arguments={
        "prompt": prompt,
        "loras": [{"path": lora_url, "scale": 0.8}],
        "image_size": "square",
        "num_inference_steps": 28,
    })
    # ê²°ê³¼ ì´ë¯¸ì§€ ì €ì¥
```

**LoRA scale ê°’ ì„¤ëª…**:
- `scale: 0.8` = ê¸°ë³¸ ì¶”ì²œê°’ (ìºë¦­í„° íŠ¹ì§• 80% ë°˜ì˜)
- `scale: 1.0` = ìºë¦­í„° íŠ¹ì§• ìµœëŒ€ ë°˜ì˜ (ê³¼ì í•©ë  ìˆ˜ ìˆìŒ)
- `scale: 0.5` = ì•½í•˜ê²Œ ë°˜ì˜ (ìŠ¤íƒ€ì¼ì´ ë” ììœ ë¡œì›€)
- ì‚¬ìš©ìê°€ ì´í›„ ìƒì„± ì‹œ scale ê°’ì„ ì¡°ì ˆí•  ìˆ˜ ìˆë„ë¡ UI ì œê³µ

**ì™„ë£Œ ì•Œë¦¼ UI**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… ìºë¦­í„° í•™ìŠµ ì™„ë£Œ! â€” ë°•ì‚¬ì¥                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                   â”‚
â”‚  í…ŒìŠ¤íŠ¸ ìƒì„± ê²°ê³¼:                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚[img1] â”‚ â”‚[img2] â”‚ â”‚[img3] â”‚                     â”‚
â”‚  â”‚ì •ë©´   â”‚ â”‚ì‚¬ë¬´ì‹¤  â”‚ â”‚ì „ì‹    â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                   â”‚
â”‚  íŠ¸ë¦¬ê±° ì›Œë“œ: sks_parkboss                          â”‚
â”‚  í•™ìŠµ ì´ë¯¸ì§€: 20ì¥                                   â”‚
â”‚  í•™ìŠµ ì‹œê°„: 18ë¶„ 32ì´ˆ                                â”‚
â”‚  ë¹„ìš©: $2.52 (ìƒì„± $0.50 + í•™ìŠµ $2.00 + í…ŒìŠ¤íŠ¸ $0.02) â”‚
â”‚                                                   â”‚
â”‚  [ìºë¦­í„° ê´€ë¦¬ë¡œ ì´ë™]  [ë°”ë¡œ ì›¹íˆ° ë§Œë“¤ê¸°]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 8: ë‚´ ìºë¦­í„° íƒ­ì— ìë™ ì €ì¥

**ëª©ì **: í•™ìŠµëœ ìºë¦­í„°ë¥¼ ì˜êµ¬ ì €ì¥í•˜ì—¬ ì´í›„ ì›¹íˆ° ì œì‘ì—ì„œ ì¬ì‚¬ìš©í•œë‹¤.

â†’ ìì„¸í•œ ë‚´ìš©ì€ [5. ìºë¦­í„° ê´€ë¦¬ íƒ­ (My Characters)](#5-ìºë¦­í„°-ê´€ë¦¬-íƒ­-my-characters) ì°¸ì¡°.

---

## 4. ë¹„ìš© ì•ˆë‚´ (íˆ¬ëª…ì„±)

**í•™ìŠµ ì „ ë°˜ë“œì‹œ ë¹„ìš© ì•ˆë‚´ë¥¼ í‘œì‹œ**í•œë‹¤. ì‚¬ìš©ìê°€ [í™•ì¸] ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ í•™ìŠµì´ ì‹œì‘ëœë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ LoRA í•™ìŠµ ë¹„ìš© ì•ˆë‚´                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                   â”‚
â”‚  ğŸ“¸ 24ì»· ìƒì„±:          ~$0.50  (â‚©700)            â”‚
â”‚  ğŸ§  LoRA í•™ìŠµ:          ~$2.00  (â‚©2,800)         â”‚
â”‚  ğŸ§ª í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ 3ì¥:    ~$0.06  (â‚©80)            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
â”‚  ğŸ’° ì´ ì˜ˆìƒ ë¹„ìš©:         ~$2.56  (â‚©3,580)         â”‚
â”‚                                                   â”‚
â”‚  ğŸ“Œ ì´í›„ ì´ ìºë¦­í„° ì‚¬ìš© ì‹œ: ì¥ë‹¹ â‚©30~60             â”‚
â”‚     (ì›¹íˆ° 1í¸ 10ì»· ê¸°ì¤€: â‚©300~600)                 â”‚
â”‚                                                   â”‚
â”‚  â„¹ï¸ í•œë²ˆ í•™ìŠµí•˜ë©´ ì´ ìºë¦­í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜      â”‚
â”‚     ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ í•™ìŠµ ë¹„ìš©ì€ ì—†ìŠµë‹ˆë‹¤.               â”‚
â”‚                                                   â”‚
â”‚         [ì·¨ì†Œ]            [í•™ìŠµ ì‹œì‘ â†’]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë¹„ìš© ìƒì„¸ breakdown**:

| í•­ëª© | API | ë‹¨ê°€ | ìˆ˜ëŸ‰ | ì†Œê³„ |
|------|-----|------|------|------|
| 24ì»· ì´ë¯¸ì§€ ìƒì„± | GPT Image / Flux Kontext | ~$0.02/ì¥ | 24ì¥ | ~$0.50 |
| LoRA í•™ìŠµ | fal-ai/flux-lora-portrait-trainer | ~$2.00/íšŒ | 1íšŒ | ~$2.00 |
| í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ | fal-ai/flux-lora | ~$0.02/ì¥ | 3ì¥ | ~$0.06 |
| **ì´ê³„** | | | | **~$2.56** |
| ì´í›„ ì‚¬ìš© (ìºë¦­í„° ìƒì„±) | fal-ai/flux-lora | ~$0.02~0.04/ì¥ | - | ì¥ë‹¹ |

---

## 5. ìºë¦­í„° ê´€ë¦¬ íƒ­ (My Characters)

### 5.1 UI êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ ë‚´ ìºë¦­í„° (í•™ìŠµë¨)                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€ ğŸ§‘ ë°•ì‚¬ì¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ìŠ¤íƒ€ì¼: ì›ë³¸ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ                        â”‚  â”‚
â”‚  â”‚ í•™ìŠµì¼: 2026.02.12                             â”‚  â”‚
â”‚  â”‚ íŠ¸ë¦¬ê±° ì›Œë“œ: sks_parkboss                       â”‚  â”‚
â”‚  â”‚ í•™ìŠµ ì´ë¯¸ì§€: 20/24ì¥ ì‚¬ìš©                        â”‚  â”‚
â”‚  â”‚ LoRA Scale ê¸°ë³¸ê°’: 0.8                          â”‚  â”‚
â”‚  â”‚                                                â”‚  â”‚
â”‚  â”‚ [ë¯¸ë¦¬ë³´ê¸°]                                      â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                          â”‚  â”‚
â”‚  â”‚ â”‚ìƒ˜í”Œ1â”‚ â”‚ìƒ˜í”Œ2â”‚ â”‚ìƒ˜í”Œ3â”‚                          â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜                          â”‚  â”‚
â”‚  â”‚                                                â”‚  â”‚
â”‚  â”‚ [í…ŒìŠ¤íŠ¸ ìƒì„±]  [ì¬í•™ìŠµ]  [ë‹¤ìš´ë¡œë“œ]  [ì‚­ì œ]        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€ ğŸ‘© ê¹€ì„¸ë¬´ì‚¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ìŠ¤íƒ€ì¼: 2ë“±ì‹  ì¹˜ë¹„                              â”‚  â”‚
â”‚  â”‚ í•™ìŠµì¼: 2026.02.13                             â”‚  â”‚
â”‚  â”‚ íŠ¸ë¦¬ê±° ì›Œë“œ: sks_kimtax                         â”‚  â”‚
â”‚  â”‚ ...                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                   â”‚
â”‚          [+ ìƒˆ ìºë¦­í„° í•™ìŠµ]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ìºë¦­í„° ë°ì´í„° ëª¨ë¸

```python
# DB ëª¨ë¸ (SQLAlchemy ë˜ëŠ” ë™ê¸‰)
class TrainedCharacter:
    id: str                    # UUID
    name: str                  # ìºë¦­í„° ì´ë¦„ (í•œê¸€, ì˜ˆ: "ë°•ì‚¬ì¥")
    trigger_word: str          # LoRA íŠ¸ë¦¬ê±° ì›Œë“œ (ì˜ˆ: "sks_parkboss")
    style_id: str              # í•™ìŠµì— ì‚¬ìš©ëœ ìŠ¤íƒ€ì¼ ("original", "realistic_sketch", ...)
    style_label: str           # ìŠ¤íƒ€ì¼ í‘œì‹œëª… ("ì›ë³¸ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ", "ì‹¤ì‚¬+ì†ê·¸ë¦¼", ...)
    lora_url: str              # fal.ai LoRA íŒŒì¼ URL
    lora_scale_default: float  # ê¸°ë³¸ LoRA scale (0.8)
    training_images_count: int # í•™ìŠµì— ì‚¬ìš©ëœ ì´ë¯¸ì§€ ìˆ˜
    training_steps: int        # í•™ìŠµ ìŠ¤í… ìˆ˜
    reference_sheet_url: str   # 24ì»· ì‹œíŠ¸ ì›ë³¸ URL (ë¯¸ë¦¬ë³´ê¸°ìš©)
    sample_images: list[str]   # í…ŒìŠ¤íŠ¸ ìƒì„± ìƒ˜í”Œ ì´ë¯¸ì§€ URLs
    original_photo_url: str    # ìµœì´ˆ ì—…ë¡œë“œí•œ ì‚¬ì§„ URL
    created_at: datetime       # í•™ìŠµ ì™„ë£Œ ì‹œê°
    status: str                # "active" | "training" | "failed" | "deleted"
    
    # ë¡œì»¬ ë°±ì—… ì •ë³´
    local_backup_path: str     # ë¡œì»¬ ë°±ì—… ê²½ë¡œ (ìˆìœ¼ë©´)
    lora_file_backed_up: bool  # safetensors íŒŒì¼ ë°±ì—… ì—¬ë¶€
```

### 5.3 ìºë¦­í„° ê´€ë¦¬ ê¸°ëŠ¥

**í…ŒìŠ¤íŠ¸ ìƒì„±**:
- ì‚¬ìš©ìê°€ ì§ì ‘ í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•˜ì—¬ ìºë¦­í„°ë¡œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ë³¼ ìˆ˜ ìˆìŒ
- í”„ë¡¬í”„íŠ¸ ì…ë ¥ë€ì— íŠ¸ë¦¬ê±° ì›Œë“œê°€ ìë™ ì‚½ì…ë¨
- LoRA scale ìŠ¬ë¼ì´ë” ì œê³µ (0.1~1.5, ê¸°ë³¸ 0.8)

**ì¬í•™ìŠµ**:
- ê¸°ì¡´ í•™ìŠµ ë°ì´í„° + ì¶”ê°€ ì´ë¯¸ì§€ë¡œ ì¬í•™ìŠµ
- ì´ì „ LoRAë¥¼ ë®ì–´ì“°ê¸° ë˜ëŠ” ìƒˆ ë²„ì „ìœ¼ë¡œ ì €ì¥ ì„ íƒ ê°€ëŠ¥
- ë¹„ìš©: ~$2.00 ì¶”ê°€

**ë‹¤ìš´ë¡œë“œ (ë¡œì»¬ ë°±ì—…)**:
- LoRA íŒŒì¼(.safetensors)ê³¼ ë©”íƒ€ë°ì´í„°ë¥¼ ZIPìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ
- fal.ai URL ë§Œë£Œ ëŒ€ë¹„
- ë‹¤ìš´ë¡œë“œ ë‚´ìš©:
```
parkboss_backup.zip
â”œâ”€â”€ lora_weights.safetensors    â† LoRA ëª¨ë¸ íŒŒì¼
â”œâ”€â”€ reference_sheet/            â† í•™ìŠµì— ì‚¬ìš©ëœ ì´ë¯¸ì§€ë“¤
â”‚   â”œâ”€â”€ 01.jpg
â”‚   â”œâ”€â”€ 02.jpg
â”‚   â””â”€â”€ ...
â”œâ”€â”€ samples/                    â† í…ŒìŠ¤íŠ¸ ìƒì„± ìƒ˜í”Œ
â”‚   â”œâ”€â”€ test_01.jpg
â”‚   â”œâ”€â”€ test_02.jpg
â”‚   â””â”€â”€ test_03.jpg
â”œâ”€â”€ metadata.json               â† ì•„ë˜ ì°¸ì¡°
â””â”€â”€ original_photo.jpg          â† ìµœì´ˆ ì—…ë¡œë“œ ì‚¬ì§„
```

**metadata.json êµ¬ì¡°**:
```json
{
  "character_name": "ë°•ì‚¬ì¥",
  "trigger_word": "sks_parkboss",
  "style_id": "original",
  "style_label": "ì›ë³¸ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ",
  "lora_url": "https://fal.media/files/.../lora_weights.safetensors",
  "lora_scale_default": 0.8,
  "training_images_count": 20,
  "training_steps": 1500,
  "learning_rate": 0.0001,
  "resolution": 1024,
  "created_at": "2026-02-12T15:30:00Z",
  "fal_model_used": "fal-ai/flux-lora-portrait-trainer",
  "program_version": "1.0.0"
}
```

**ì‚­ì œ**:
- í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ 2íšŒ (ì‹¤ìˆ˜ ë°©ì§€)
- "ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì‚­ì œí•˜ë©´ ì´ ìºë¦­í„°ë¥¼ ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
- ì‚­ì œ ì „ ë¡œì»¬ ë°±ì—… ê¶Œì¥ ì•ˆë‚´
- ì†Œí”„íŠ¸ ì‚­ì œ (statusë¥¼ "deleted"ë¡œ ë³€ê²½, 30ì¼ í›„ ì‹¤ì œ ì‚­ì œ)

**ë³µì› (ë¡œì»¬ ë°±ì—…ì—ì„œ)**:
- ë‹¤ìš´ë¡œë“œí•œ ZIPì„ ë‹¤ì‹œ ì—…ë¡œë“œí•˜ì—¬ ìºë¦­í„° ë³µì›
- fal.ai URLì´ ë§Œë£Œëœ ê²½ìš°, safetensors íŒŒì¼ì„ ë‹¤ì‹œ fal.aiì— ì—…ë¡œë“œ
- ì—…ë¡œë“œ API ì—”ë“œí¬ì¸íŠ¸ í•„ìš”

---

## 6. ì›¹íˆ° ì œì‘ ì‹œ ìºë¦­í„° ì ìš©

### 6.1 ë‹¨ì¼ ìºë¦­í„° ì ìš©

ì›¹íˆ° ì”¬ ìƒì„± ì‹œ, í•™ìŠµëœ ìºë¦­í„°ë¥¼ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ LoRAê°€ ì ìš©ëœë‹¤.

**ì”¬ ìƒì„± ì„¤ì • UIì— ì¶”ê°€í•  ìš”ì†Œ**:

```
â”Œâ”€ ì”¬ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚ ìºë¦­í„°: [ë°•ì‚¬ì¥ (í•™ìŠµë¨) â–¼]              â”‚
â”‚         â”œ ğŸ“· ë°•ì‚¬ì¥ (ì›ë³¸ ìŠ¤íƒ€ì¼)         â”‚
â”‚         â”œ ğŸ§¸ ê¹€ì„¸ë¬´ì‚¬ (2ë“±ì‹ )            â”‚
â”‚         â”œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
â”‚         â”œ í•™ìŠµ ì•ˆ ë¨ (í”„ë¡¬í”„íŠ¸ ëª¨ë“œ)       â”‚
â”‚         â”” + ìƒˆ ìºë¦­í„° í•™ìŠµ               â”‚
â”‚                                         â”‚
â”‚ LoRA ê°•ë„: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 0.8             â”‚
â”‚                                         â”‚
â”‚ í‘œì •: [ìì‹ ê° ìˆëŠ” ë¯¸ì†Œ â–¼]               â”‚
â”‚ ì¥ì†Œ: [ì‚¬ë¬´ì‹¤ â–¼]                         â”‚
â”‚ ìƒí™©: ì„¸ê¸ˆ ì‹ ê³  ì„¤ëª… ì¤‘                    â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í”„ë¡¬í”„íŠ¸ ìë™ ìƒì„± ë¡œì§**:

```python
def build_scene_prompt(character: TrainedCharacter, scene_config: dict) -> dict:
    """
    í•™ìŠµëœ ìºë¦­í„°ê°€ ì ìš©ëœ ì”¬ ìƒì„± í”„ë¡¬í”„íŠ¸ì™€ LoRA ì„¤ì •ì„ ë°˜í™˜í•œë‹¤.
    """
    prompt = (
        f"{character.trigger_word}, "
        f"{scene_config['expression']}, "
        f"{scene_config['location']}, "
        f"{scene_config['situation']}"
    )
    
    return {
        "prompt": prompt,
        "loras": [{
            "path": character.lora_url,
            "scale": scene_config.get("lora_scale", character.lora_scale_default)
        }],
        "image_size": scene_config.get("image_size", "portrait_4_3"),
        "num_inference_steps": 28,
    }
```

**ì´ë¯¸ì§€ ìƒì„± API í˜¸ì¶œ**:

```python
# í•™ìŠµëœ ìºë¦­í„°ë¡œ ì”¬ ì´ë¯¸ì§€ ìƒì„±
result = fal_client.subscribe("fal-ai/flux-lora", arguments={
    "prompt": "sks_parkboss, confident smile, office background, explaining tax report, professional setting",
    "loras": [{"path": lora_url, "scale": 0.8}],
    "image_size": "portrait_4_3",  # ì›¹íˆ° ì„¸ë¡œí˜•
    "num_inference_steps": 28,
})
scene_image_url = result["images"][0]["url"]
```

### 6.2 2ì¸ ìºë¦­í„° ì”¬

í•™ìŠµëœ ìºë¦­í„° 2ëª…ì„ í•œ ì”¬ì— ë°°ì¹˜í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.

**UI**:

```
â”Œâ”€ 2ì¸ ì”¬ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚ ìºë¦­í„° A: [ë°•ì‚¬ì¥ (í•™ìŠµë¨) â–¼]            â”‚
â”‚ ìºë¦­í„° B: [ê¹€ì„¸ë¬´ì‚¬ (í•™ìŠµë¨) â–¼]           â”‚
â”‚                                         â”‚
â”‚ ì¥ì†Œ: [ì‚¬ë¬´ì‹¤ â–¼]                         â”‚
â”‚ ìƒí™©: Aê°€ Bì—ê²Œ ì§ˆë¬¸í•˜ëŠ”                   â”‚
â”‚                                         â”‚
â”‚ A í‘œì •: [ê¶ê¸ˆí•œ í‘œì • â–¼]                  â”‚
â”‚ B í‘œì •: [ì„¤ëª…í•˜ëŠ” í‘œì • â–¼]                 â”‚
â”‚                                         â”‚
â”‚ LoRA A ê°•ë„: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 0.8           â”‚
â”‚ LoRA B ê°•ë„: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 0.7           â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í”„ë¡¬í”„íŠ¸ ìë™ ì¡°í•©**:

```python
def build_two_character_prompt(char_a: TrainedCharacter, char_b: TrainedCharacter, scene_config: dict) -> dict:
    """
    2ì¸ ìºë¦­í„° ì”¬ì˜ í”„ë¡¬í”„íŠ¸ì™€ LoRA ì„¤ì •ì„ ë°˜í™˜í•œë‹¤.
    """
    prompt = (
        f"{char_a.trigger_word} and {char_b.trigger_word}, "
        f"two people in {scene_config['location']}, "
        f"{char_a.trigger_word} is {scene_config['a_action']}, "
        f"{char_b.trigger_word} is {scene_config['b_action']}"
    )
    
    return {
        "prompt": prompt,
        "loras": [
            {"path": char_a.lora_url, "scale": scene_config.get("a_scale", 0.8)},
            {"path": char_b.lora_url, "scale": scene_config.get("b_scale", 0.7)},
        ],
        "image_size": "landscape_16_9",  # 2ì¸ ì”¬ì€ ê°€ë¡œí˜•ì´ ìœ ë¦¬
        "num_inference_steps": 30,  # 2ì¸ì€ ìŠ¤í… ì•½ê°„ ë†’ì„
    }
```

**âš ï¸ 2ì¸ ì”¬ ì œí•œì‚¬í•­ (ë°˜ë“œì‹œ ì•ˆë‚´)**:
- 2ê°œì˜ LoRAë¥¼ ë™ì‹œì— ì ìš©í•˜ë©´ ê° ìºë¦­í„°ì˜ íŠ¹ì§•ì´ ì•½í•´ì§ˆ ìˆ˜ ìˆìŒ
- ê¶Œì¥: ê° LoRAì˜ scaleì„ 0.6~0.8ë¡œ ë‚®ì¶”ê¸° (í•©ì´ 1.5ë¥¼ ë„˜ì§€ ì•Šë„ë¡)
- ë‘ ìºë¦­í„°ê°€ ë¹„ìŠ·í•œ ìŠ¤íƒ€ì¼ì´ë©´ í˜¼ë™ë  ìˆ˜ ìˆìŒ â†’ ì˜ìƒ/ë¨¸ë¦¬ìƒ‰ ë“±ìœ¼ë¡œ êµ¬ë¶„ í•„ìš”
- 3ì¸ ì´ìƒì€ í˜„ì¬ ì§€ì›í•˜ì§€ ì•ŠìŒ (í’ˆì§ˆ ë³´ì¥ ì–´ë ¤ì›€)

---

## 7. ì˜¤í”„ë¼ì¸/ì¬ì‚¬ìš© ëŒ€ë¹„ ë¡œì»¬ ë°±ì—… ì‹œìŠ¤í…œ

### 7.1 ë¡œì»¬ ì €ì¥ êµ¬ì¡°

```
{ì•± ë°ì´í„° í´ë”}/characters/
â”œâ”€â”€ parkboss/
â”‚   â”œâ”€â”€ lora_weights.safetensors    â† LoRA ëª¨ë¸ íŒŒì¼ (í•µì‹¬!)
â”‚   â”œâ”€â”€ reference_images/           â† í•™ìŠµì— ì‚¬ìš©ëœ ì´ë¯¸ì§€
â”‚   â”‚   â”œâ”€â”€ 01.jpg
â”‚   â”‚   â”œâ”€â”€ 02.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ samples/                    â† í…ŒìŠ¤íŠ¸ ìƒì„± ìƒ˜í”Œ
â”‚   â”‚   â”œâ”€â”€ test_01.jpg
â”‚   â”‚   â”œâ”€â”€ test_02.jpg
â”‚   â”‚   â””â”€â”€ test_03.jpg
â”‚   â”œâ”€â”€ original_photo.jpg          â† ìµœì´ˆ ì—…ë¡œë“œ ì‚¬ì§„
â”‚   â””â”€â”€ metadata.json               â† ëª¨ë“  ì„¤ì •ê³¼ ì •ë³´
â”‚
â”œâ”€â”€ kimtax/
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ characters_index.json           â† ìºë¦­í„° ëª©ë¡ ì¸ë±ìŠ¤
```

### 7.2 ìë™ ë°±ì—… ì •ì±…

- **í•™ìŠµ ì™„ë£Œ ì‹œ**: LoRA íŒŒì¼(.safetensors)ì„ ìë™ìœ¼ë¡œ ë¡œì»¬ì— ë‹¤ìš´ë¡œë“œ ì‹œë„
- **ì‹¤íŒ¨ ì‹œ**: "ë¡œì»¬ ë°±ì—…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œí•´ì£¼ì„¸ìš”." ê²½ê³ 
- **fal.ai URL ë§Œë£Œ ëŒ€ë¹„**: safetensors íŒŒì¼ì„ ë¡œì»¬ì— ë³´ê´€í•˜ë©´, ë§Œë£Œ í›„ì—ë„ ì¬ì—…ë¡œë“œí•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥

### 7.3 ë³µì› ì›Œí¬í”Œë¡œìš°

```
[ì‚¬ìš©ìê°€ ë°±ì—… ZIP ì—…ë¡œë“œ]
    â†“
[metadata.jsonì—ì„œ ì„¤ì • ì½ê¸°]
    â†“
[lora_weights.safetensorsë¥¼ fal.aiì— ì¬ì—…ë¡œë“œ]
    â†“
[ìƒˆ LoRA URL ë°œê¸‰]
    â†“
[ìºë¦­í„° DBì— ì¬ë“±ë¡]
    â†“
[ì‚¬ìš© ê°€ëŠ¥ ìƒíƒœë¡œ ë³µì›]
```

---

## 8. API ì—”ë“œí¬ì¸íŠ¸ ì „ì²´ ëª©ë¡

### 8.1 ìºë¦­í„° í•™ìŠµ ê´€ë ¨

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/character/upload-photo` | ì‚¬ì§„ ì—…ë¡œë“œ |
| POST | `/api/character/select-style` | ìŠ¤íƒ€ì¼ ì„ íƒ |
| POST | `/api/character/generate-24-cuts` | 24ì»· ìë™ ìƒì„± ì‹œì‘ |
| GET | `/api/character/generation-status/{task_id}` | 24ì»· ìƒì„± ì§„í–‰ ìƒíƒœ |
| POST | `/api/character/select-cuts` | ì´ë¯¸ì§€ ì„ ë³„ |
| POST | `/api/character/generate-additional` | ì¶”ê°€ ì´ë¯¸ì§€ ìƒì„± |
| POST | `/api/character/prepare-training-data` | í•™ìŠµ ë°ì´í„° íŒ¨í‚¤ì§• |
| POST | `/api/character/start-training` | LoRA í•™ìŠµ ì‹œì‘ |
| GET | `/api/character/training-status/{task_id}` | í•™ìŠµ ì§„í–‰ ìƒíƒœ |

### 8.2 ìºë¦­í„° ê´€ë¦¬ ê´€ë ¨

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/api/character/list` | í•™ìŠµëœ ìºë¦­í„° ëª©ë¡ |
| GET | `/api/character/{id}` | ìºë¦­í„° ìƒì„¸ ì •ë³´ |
| POST | `/api/character/{id}/test-generate` | í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìƒì„± |
| POST | `/api/character/{id}/retrain` | ì¬í•™ìŠµ |
| GET | `/api/character/{id}/download-backup` | ë¡œì»¬ ë°±ì—… ZIP ë‹¤ìš´ë¡œë“œ |
| POST | `/api/character/restore-from-backup` | ë°±ì—…ì—ì„œ ë³µì› |
| DELETE | `/api/character/{id}` | ìºë¦­í„° ì‚­ì œ (ì†Œí”„íŠ¸) |
| PATCH | `/api/character/{id}` | ìºë¦­í„° ì •ë³´ ìˆ˜ì • (ì´ë¦„, scale ê¸°ë³¸ê°’ ë“±) |

### 8.3 ì”¬ ìƒì„± ì‹œ ìºë¦­í„° ì ìš©

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/scene/generate-with-character` | í•™ìŠµëœ ìºë¦­í„°ë¡œ ì”¬ ìƒì„± |
| POST | `/api/scene/generate-two-characters` | 2ì¸ ìºë¦­í„° ì”¬ ìƒì„± |

---

## 9. ì™¸ë¶€ API ì˜ì¡´ì„±

### 9.1 fal.ai (í•„ìˆ˜)

**í•„ìš”í•œ API í‚¤**: `FAL_KEY` (1ê°œ)
**ë“±ë¡**: https://fal.ai â†’ Sign Up â†’ Dashboard â†’ Keys â†’ Create Key
**ê²°ì œ**: Pay-as-you-go (ì¢…ëŸ‰ì œ, ì¹´ë“œ ë“±ë¡ í•„ìš”)
**ë¬´ë£Œ í¬ë ˆë”§**: ì†ŒëŸ‰ ì œê³µ (í…ŒìŠ¤íŠ¸ìš©)

**ì‚¬ìš© ëª¨ë¸**:

| ëª¨ë¸ | ì—”ë“œí¬ì¸íŠ¸ | ìš©ë„ | ë‹¨ê°€ |
|------|-----------|------|------|
| Flux Kontext | `fal-ai/flux-kontext` | ì›ë³¸ ìŠ¤íƒ€ì¼ 24ì»· ìƒì„± (Step 3, ê²½ë¡œ A) | ~$0.03/ì¥ |
| Flux LoRA Trainer | `fal-ai/flux-lora-portrait-trainer` | LoRA í•™ìŠµ (Step 6) | ~$2.00/íšŒ |
| Flux + LoRA ì¶”ë¡  | `fal-ai/flux-lora` | í•™ìŠµëœ ìºë¦­í„°ë¡œ ì´ë¯¸ì§€ ìƒì„± | ~$0.02~0.04/ì¥ |

**Python SDK ì„¤ì¹˜**:
```bash
pip install fal-client
```

**í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**:
```
FAL_KEY=fal_sk_xxxxxxxxxxxx
```

### 9.2 ê¸°ì¡´ ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸ (GPT Image ë“±)

- ìŠ¤íƒ€ì¼ ë³€í™˜ ì‹œ (ê²½ë¡œ B) ê¸°ì¡´ í”„ë¡œì íŠ¸ì˜ ì´ë¯¸ì§€ ìƒì„± íŒŒì´í”„ë¼ì¸ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ì¶”ê°€ API í‚¤ ë¶ˆí•„ìš” (ê¸°ì¡´ í‚¤ í™œìš©)

---

## 10. êµ¬í˜„ ìš°ì„ ìˆœìœ„ ë° í˜ì´ì¦ˆ ê³„íš

### Phase 1 (MVP â€” ë¨¼ì € êµ¬í˜„)

**ëª©í‘œ**: í•µì‹¬ ì›Œí¬í”Œë¡œìš°ê°€ ë™ì‘í•˜ëŠ” ìµœì†Œ ê¸°ëŠ¥

1. âœ… ì‚¬ì§„ ì—…ë¡œë“œ (Step 1)
2. âœ… ìŠ¤íƒ€ì¼ ì„ íƒ â€” `original`ê³¼ `realistic_sketch` 2ê°€ì§€ë§Œ ìš°ì„  (Step 2)
3. âœ… 24ì»· ìƒì„± (Step 3)
4. âœ… ë¯¸ë¦¬ë³´ê¸° + ì„ ë³„ (Step 4)
5. âœ… ZIP íŒ¨í‚¤ì§• (Step 5)
6. âœ… LoRA í•™ìŠµ ì‹¤í–‰ (Step 6)
7. âœ… ì™„ë£Œ + í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ (Step 7)
8. âœ… ìºë¦­í„° ëª©ë¡ + ê¸°ë³¸ ê´€ë¦¬ (Step 8)
9. âœ… ì›¹íˆ° ì”¬ ìƒì„± ì‹œ ìºë¦­í„° ì ìš© (6.1)
10. âœ… ë¹„ìš© ì•ˆë‚´ (4)

### Phase 2 (í™•ì¥)

11. ë‚˜ë¨¸ì§€ ìŠ¤íƒ€ì¼ 4ì¢… ì¶”ê°€ (`chibi_2head`, `kakao_emoticon`, `simple_lineart`, `custom`)
12. 2ì¸ ìºë¦­í„° ì”¬ (6.2)
13. ë¡œì»¬ ë°±ì—…/ë³µì› (7)
14. ìºë¦­í„° ì¬í•™ìŠµ ê¸°ëŠ¥
15. LoRA scale ë¯¸ì„¸ ì¡°ì ˆ UI

### Phase 3 (ê³ ë„í™”)

16. ì¶”ê°€ ìƒì„± ê¸°ëŠ¥ (ì¹´í…Œê³ ë¦¬ë³„)
17. ìºë¦­í„° ë²„ì „ ê´€ë¦¬ (v1, v2, ...)
18. ìºë¦­í„° ê³µìœ /ë‚´ë³´ë‚´ê¸°
19. ë°°ì¹˜ í•™ìŠµ (ì—¬ëŸ¬ ìºë¦­í„° í•œêº¼ë²ˆì—)

---

## 11. ì¶”ê°€ ë³´ì™„ ì‚¬í•­ â€” êµ¬í˜„ ì‹œ ì£¼ì˜ì 

### 11.1 ì›ë³¸ ìŠ¤íƒ€ì¼(`original`) ì˜µì…˜ì˜ ê¸°ìˆ ì  ì°¨ì´

ì´ ì˜µì…˜ì€ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ê³¼ ì´ë¯¸ì§€ ìƒì„± ê²½ë¡œê°€ ë‹¤ë¥´ë¯€ë¡œ ë°˜ë“œì‹œ ë¶„ê¸° ì²˜ë¦¬í•´ì•¼ í•œë‹¤:

```python
if style_id == "original":
    # Flux Kontext (img2img) ì‚¬ìš©
    # â†’ ì›ë³¸ ì´ë¯¸ì§€ë¥¼ inputìœ¼ë¡œ ë„£ê³ , í¬ì¦ˆ/í‘œì •ë§Œ ë³€ê²½
    # â†’ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ ì¶”ê°€ ì•ˆ í•¨
    api_endpoint = "fal-ai/flux-kontext"
    arguments = {
        "prompt": pose_prompt_only,
        "image_url": original_photo_url,
    }
else:
    # ê¸°ì¡´ ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸ (text2img + reference)
    # â†’ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ + í¬ì¦ˆ í”„ë¡¬í”„íŠ¸ ì¡°í•©
    # â†’ ì›ë³¸ ì‚¬ì§„ì€ ë ˆí¼ëŸ°ìŠ¤ë¡œ ì²¨ë¶€
    api_endpoint = "ê¸°ì¡´ ëª¨ë¸"
    arguments = {
        "prompt": style_prompt + pose_prompt,
        "reference_image": original_photo_url,
    }
```

### 11.2 íŠ¸ë¦¬ê±° ì›Œë“œ ì¶©ëŒ ë°©ì§€

- íŠ¸ë¦¬ê±° ì›Œë“œëŠ” ì „ì²´ ì‹œìŠ¤í…œì—ì„œ ê³ ìœ í•´ì•¼ í•¨
- ê°™ì€ ì´ë¦„ì˜ ìºë¦­í„°ë¥¼ ì—¬ëŸ¬ ë²ˆ í•™ìŠµí•˜ë©´ â†’ `sks_parkboss`, `sks_parkboss2`, `sks_parkboss3`
- DBì—ì„œ ì¤‘ë³µ ì²´í¬ í•„ìˆ˜

### 11.3 fal.ai URL ë§Œë£Œ ëŒ€ì‘

- fal.aiì—ì„œ ìƒì„±ëœ íŒŒì¼ URLì€ **ì¼ì • ê¸°ê°„ í›„ ë§Œë£Œ**ë  ìˆ˜ ìˆìŒ
- í•™ìŠµ ì™„ë£Œ ì¦‰ì‹œ LoRA íŒŒì¼ì„ ìš°ë¦¬ ì„œë²„(ë˜ëŠ” ë¡œì»¬)ì— ë°±ì—…í•˜ëŠ” ê²ƒì´ ì•ˆì „
- ë§Œë£Œëœ URLì„ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë©´ ì—ëŸ¬ â†’ ì¬ì—…ë¡œë“œ ì•ˆë‚´

### 11.4 ë™ì‹œ í•™ìŠµ ì œí•œ

- í•œ ì‚¬ìš©ìê°€ ë™ì‹œì— ì—¬ëŸ¬ ìºë¦­í„°ë¥¼ í•™ìŠµí•˜ëŠ” ê²ƒì€ í—ˆìš©í•˜ë˜, **ìµœëŒ€ 2ê°œê¹Œì§€**ë¡œ ì œí•œ ê¶Œì¥
- fal.ai ë™ì‹œ ìš”ì²­ ì œí•œì´ ìˆì„ ìˆ˜ ìˆìŒ
- í ì‹œìŠ¤í…œ ë„ì… ê²€í†  (Redis Queue ë“±)

### 11.5 í•™ìŠµ ì‹¤íŒ¨ ë³µêµ¬

- fal.ai í•™ìŠµì´ ì¤‘ê°„ì— ì‹¤íŒ¨í•˜ëŠ” ê²½ìš°:
  - ìë™ ì¬ì‹œë„ ìµœëŒ€ 2íšŒ
  - 3íšŒ ëª¨ë‘ ì‹¤íŒ¨ ì‹œ: "í•™ìŠµì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë¯¸ì§€ë¡œ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”." + ë¹„ìš© ë¯¸ì²­êµ¬ ì•ˆë‚´
  - ì‹¤íŒ¨ ì›ì¸ì„ ë¡œê·¸ì— ê¸°ë¡ (ë””ë²„ê¹…ìš©)

### 11.6 ì´ë¯¸ì§€ í’ˆì§ˆ ê²€ì¦

- 24ì»· ìƒì„± í›„, ìë™ í’ˆì§ˆ ê²€ì¦ ê³ ë ¤:
  - ì–¼êµ´ì´ ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ (face detection)
  - ë°°ê²½ì´ ê¹¨ë—í•œì§€
  - ì‹¬í•œ ì™œê³¡ì´ ì—†ëŠ”ì§€
- í’ˆì§ˆì´ ë‚®ì€ ì´ë¯¸ì§€ëŠ” ìë™ìœ¼ë¡œ ì²´í¬ í•´ì œ + ê²½ê³  í‘œì‹œ
- Phase 2ì—ì„œ êµ¬í˜„ ê°€ëŠ¥

### 11.7 ìºë¦­í„° í•™ìŠµ íƒ­ê³¼ ê¸°ì¡´ ìŠ¤íƒ€ì¼ íƒ­ì˜ ê´€ê³„

í˜„ì¬ í”„ë¡œê·¸ë¨ì—ëŠ” "ìŠ¤íƒ€ì¼ íƒ­"ì´ ìˆì„ ìˆ˜ ìˆë‹¤. í•™ìŠµëœ ìºë¦­í„°ëŠ”:
- **ìŠ¤íƒ€ì¼ íƒ­ê³¼ ë³„ë„**ë¡œ "ë‚´ ìºë¦­í„°" íƒ­ì—ì„œ ê´€ë¦¬
- ì”¬ ìƒì„± ì‹œ "ìºë¦­í„° ì„ íƒ" ë“œë¡­ë‹¤ìš´ì— í•™ìŠµëœ ìºë¦­í„°ê°€ í‘œì‹œ
- ìŠ¤íƒ€ì¼ íƒ­ì˜ í”„ë¦¬ì…‹ ìŠ¤íƒ€ì¼ + ìºë¦­í„° LoRAë¥¼ ë™ì‹œì— ì ìš©í•  ìˆ˜ë„ ìˆìŒ (ê³ ê¸‰ ê¸°ëŠ¥)

### 11.8 ì—ëŸ¬ ìƒíƒœ ê´€ë¦¬

ì „ì²´ ì›Œí¬í”Œë¡œìš°ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì—ëŸ¬ ìƒíƒœ:

| ë‹¨ê³„ | ì—ëŸ¬ | ëŒ€ì‘ |
|------|------|------|
| ì‚¬ì§„ ì—…ë¡œë“œ | íŒŒì¼ í˜•ì‹ ì˜¤ë¥˜ | "JPG, PNG, WEBPë§Œ ì§€ì›í•©ë‹ˆë‹¤" |
| ì‚¬ì§„ ì—…ë¡œë“œ | í•´ìƒë„ ë„ˆë¬´ ë‚®ìŒ | "ìµœì†Œ 512Ã—512 ì´ìƒ ê¶Œì¥í•©ë‹ˆë‹¤" (ê²½ê³ , ì§„í–‰ í—ˆìš©) |
| 24ì»· ìƒì„± | API í˜¸ì¶œ ì‹¤íŒ¨ | ê°œë³„ ì»· ì¬ì‹œë„ (ìµœëŒ€ 3íšŒ), ì‹¤íŒ¨ ì»·ì€ ë¹ˆì¹¸ í‘œì‹œ |
| 24ì»· ìƒì„± | ì‹œê°„ ì´ˆê³¼ (10ë¶„) | "ìƒì„±ì´ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”." |
| ì´ë¯¸ì§€ ì„ ë³„ | 15ì¥ ë¯¸ë§Œ ì„ íƒ | ê²½ê³  í‘œì‹œ, ì§„í–‰ í—ˆìš© (ì‚¬ìš©ì íŒë‹¨) |
| LoRA í•™ìŠµ | í•™ìŠµ ì‹¤íŒ¨ | ìë™ ì¬ì‹œë„ 2íšŒ â†’ ì‹¤íŒ¨ ì•ˆë‚´ |
| LoRA í•™ìŠµ | íƒ€ì„ì•„ì›ƒ (60ë¶„) | ì‹¤íŒ¨ ì²˜ë¦¬ + ì•ˆë‚´ |
| í…ŒìŠ¤íŠ¸ ìƒì„± | ì´ë¯¸ì§€ í’ˆì§ˆ ì €í•˜ | "í•™ìŠµ ê²°ê³¼ê°€ ë§Œì¡±ìŠ¤ëŸ½ì§€ ì•Šìœ¼ë©´ ì¬í•™ìŠµì„ ì‹œë„í•´ë³´ì„¸ìš”" |
| LoRA URL ë§Œë£Œ | ìƒì„± ì‹œ 404 | "LoRA íŒŒì¼ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë°±ì—…ì—ì„œ ë³µì›í•´ì£¼ì„¸ìš”." |

---

## 12. í™˜ê²½ ì„¤ì • (Config)

```python
# config.py ë˜ëŠ” .envì— ì¶”ê°€í•  ì„¤ì •ë“¤

# fal.ai
FAL_KEY = "fal_sk_xxxxxxxxxxxx"

# ìºë¦­í„° í•™ìŠµ ê¸°ë³¸ê°’
CHARACTER_TRAINING_STEPS = 1500          # í•™ìŠµ ìŠ¤í… ìˆ˜
CHARACTER_TRAINING_LEARNING_RATE = 1e-4  # í•™ìŠµë¥ 
CHARACTER_TRAINING_RESOLUTION = 1024     # í•™ìŠµ í•´ìƒë„
CHARACTER_TRAINING_CREATE_MASKS = True   # ì–¼êµ´ ë§ˆìŠ¤í‚¹

# 24ì»· ìƒì„±
GENERATION_CUTS_COUNT = 24               # ê¸°ë³¸ ìƒì„± ì»· ìˆ˜
GENERATION_ADDITIONAL_COUNT = 4          # ì¶”ê°€ ìƒì„± ì‹œ ì»· ìˆ˜
MIN_SELECTED_CUTS = 15                   # ìµœì†Œ ì„ íƒ ì»· ìˆ˜
RECOMMENDED_SELECTED_CUTS = 20           # ê¶Œì¥ ì„ íƒ ì»· ìˆ˜

# LoRA ì¶”ë¡  ê¸°ë³¸ê°’
LORA_SCALE_DEFAULT = 0.8                 # ê¸°ë³¸ LoRA ê°•ë„
LORA_SCALE_MIN = 0.1                     # ìµœì†Œ
LORA_SCALE_MAX = 1.5                     # ìµœëŒ€
INFERENCE_STEPS = 28                     # ì¶”ë¡  ìŠ¤í…

# ìºë¦­í„° ê´€ë¦¬
MAX_CONCURRENT_TRAINING = 2             # ë™ì‹œ í•™ìŠµ ìµœëŒ€ ìˆ˜
TRAINING_TIMEOUT_SECONDS = 3600         # í•™ìŠµ íƒ€ì„ì•„ì›ƒ (60ë¶„)
TRAINING_MAX_RETRIES = 2                # í•™ìŠµ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„
SOFT_DELETE_DAYS = 30                   # ì†Œí”„íŠ¸ ì‚­ì œ í›„ ì‹¤ì œ ì‚­ì œê¹Œì§€ ì¼ìˆ˜

# ë¡œì»¬ ë°±ì—…
LOCAL_BACKUP_PATH = "{APP_DATA}/characters/"
AUTO_BACKUP_ENABLED = True              # í•™ìŠµ ì™„ë£Œ ì‹œ ìë™ ë¡œì»¬ ë°±ì—…

# ë¹„ìš© (í‘œì‹œìš©, ì‹¤ì œ ë¹„ìš©ì€ fal.aiì—ì„œ ì²­êµ¬)
COST_PER_IMAGE_GENERATION = 0.02        # $/ì¥
COST_PER_LORA_TRAINING = 2.00           # $/íšŒ
COST_PER_LORA_INFERENCE = 0.03          # $/ì¥
```

---

## 13. íŒŒì¼/ë””ë ‰í† ë¦¬ êµ¬ì¡° (í”„ë¡œì íŠ¸ ë‚´)

ì´ ê¸°ëŠ¥ì„ ìœ„í•´ í”„ë¡œì íŠ¸ì— ì¶”ê°€í•´ì•¼ í•  íŒŒì¼ë“¤:

```
project/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ character/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ router.py              â† FastAPI ë¼ìš°í„° (ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸)
â”‚       â”œâ”€â”€ schemas.py             â† Pydantic ëª¨ë¸ (Request/Response)
â”‚       â”œâ”€â”€ service.py             â† ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚       â”œâ”€â”€ training_service.py    â† fal.ai LoRA í•™ìŠµ ë¡œì§
â”‚       â”œâ”€â”€ generation_service.py  â† 24ì»· ìƒì„± ë¡œì§
â”‚       â””â”€â”€ backup_service.py      â† ë¡œì»¬ ë°±ì—…/ë³µì› ë¡œì§
â”‚
â”œâ”€â”€ models/
â”‚   â””â”€â”€ trained_character.py       â† DB ëª¨ë¸
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ character_config.py        â† ìºë¦­í„° ê´€ë ¨ ì„¤ì •
â”‚
â”œâ”€â”€ data/
â”‚   â””â”€â”€ prompts/
â”‚       â””â”€â”€ 24cuts_prompts.json    â† 24ì»· í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”‚
â””â”€â”€ templates/
    â””â”€â”€ character/
        â”œâ”€â”€ upload.html            â† (ì›¹ UIê°€ ìˆëŠ” ê²½ìš°)
        â”œâ”€â”€ style_select.html
        â”œâ”€â”€ preview_select.html
        â”œâ”€â”€ training_progress.html
        â””â”€â”€ my_characters.html
```

---

## ë¶€ë¡ A: 24ì»· í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (JSON)

```json
{
  "cuts": [
    {"id": 1, "category": "expression", "prompt": "neutral smile, front view, looking at camera", "label_ko": "ì •ë©´ ë¯¸ì†Œ"},
    {"id": 2, "category": "expression", "prompt": "big laugh, slightly tilted head, eyes squinted", "label_ko": "í™œì§ ì›ƒìŒ"},
    {"id": 3, "category": "expression", "prompt": "surprised expression, wide eyes, open mouth", "label_ko": "ë†€ëŒ"},
    {"id": 4, "category": "expression", "prompt": "angry expression, furrowed brows, tight lips", "label_ko": "í™”ë‚¨"},
    {"id": 5, "category": "expression", "prompt": "sad expression, downcast eyes, slight frown", "label_ko": "ìŠ¬í””"},
    {"id": 6, "category": "expression", "prompt": "embarrassed expression, sweating, nervous smile", "label_ko": "ë‹¹í™©"},
    {"id": 7, "category": "expression", "prompt": "confident expression, smirk, one eyebrow raised", "label_ko": "ìì‹ ê°"},
    {"id": 8, "category": "expression", "prompt": "thinking expression, hand on chin, eyes looking up", "label_ko": "ìƒê° ì¤‘"},
    {"id": 9, "category": "angle", "prompt": "3/4 view from left side, slight smile", "label_ko": "ì¢Œì¸¡ 45ë„"},
    {"id": 10, "category": "angle", "prompt": "3/4 view from right side, slight smile", "label_ko": "ìš°ì¸¡ 45ë„"},
    {"id": 11, "category": "angle", "prompt": "left profile view, looking to the side", "label_ko": "ì¢Œì¸¡ í”„ë¡œí•„"},
    {"id": 12, "category": "angle", "prompt": "right profile view, looking to the side", "label_ko": "ìš°ì¸¡ í”„ë¡œí•„"},
    {"id": 13, "category": "upper_body", "prompt": "arms crossed, confident stance, upper body", "label_ko": "íŒ”ì§±"},
    {"id": 14, "category": "upper_body", "prompt": "waving hand, friendly gesture, upper body", "label_ko": "ì† í”ë“¤ê¸°"},
    {"id": 15, "category": "upper_body", "prompt": "both hands raised, celebrating, upper body", "label_ko": "ì–‘ì† ìœ„ë¡œ"},
    {"id": 16, "category": "upper_body", "prompt": "pointing with one hand, directing, upper body", "label_ko": "í•œ ì† ê°€ë¦¬í‚¤ê¸°"},
    {"id": 17, "category": "upper_body", "prompt": "thumbs up, positive gesture, upper body", "label_ko": "ì—„ì§€ ì²™"},
    {"id": 18, "category": "upper_body", "prompt": "explaining gesture, one hand open palm, upper body", "label_ko": "ì„¤ëª…í•˜ëŠ” í¬ì¦ˆ"},
    {"id": 19, "category": "full_body", "prompt": "standing front view, full body, relaxed pose", "label_ko": "ì„œìˆëŠ” ì •ë©´"},
    {"id": 20, "category": "full_body", "prompt": "walking pose, mid-stride, full body", "label_ko": "ê±·ëŠ” í¬ì¦ˆ"},
    {"id": 21, "category": "full_body", "prompt": "sitting in chair, legs crossed, full body", "label_ko": "ì•‰ì€ í¬ì¦ˆ"},
    {"id": 22, "category": "full_body", "prompt": "looking back over shoulder, full body", "label_ko": "ë’¤ëŒì•„ë³´ê¸°"},
    {"id": 23, "category": "scene", "prompt": "in office setting, standing near desk, professional", "label_ko": "ì‚¬ë¬´ì‹¤"},
    {"id": 24, "category": "scene", "prompt": "at desk with documents, working, focused", "label_ko": "ì±…ìƒ ì•"}
  ]
}
```

---

## ë¶€ë¡ B: fal.ai API í˜¸ì¶œ ì˜ˆì‹œ ì½”ë“œ (ì „ì²´)

```python
"""
character_training_service.py
ìºë¦­í„° LoRA í•™ìŠµ ì „ì²´ íŒŒì´í”„ë¼ì¸
"""
import fal_client
import os
import json
import zipfile
from datetime import datetime

os.environ["FAL_KEY"] = "fal_sk_ì—¬ê¸°ì—_í‚¤_ì…ë ¥"


# â”€â”€â”€ Step 3: 24ì»· ìƒì„± (original ìŠ¤íƒ€ì¼) â”€â”€â”€

async def generate_24_cuts_original(photo_url: str, cuts_prompts: list[dict]) -> list[str]:
    """ì›ë³¸ ìŠ¤íƒ€ì¼: Flux Kontextë¡œ 24ì»· ìƒì„±"""
    image_urls = []
    for cut in cuts_prompts:
        result = fal_client.subscribe("fal-ai/flux-kontext", arguments={
            "prompt": f"same person, same style, {cut['prompt']}, clean background",
            "image_url": photo_url,
        })
        image_urls.append(result["images"][0]["url"])
    return image_urls


async def generate_24_cuts_styled(photo_url: str, style_prompt: str, cuts_prompts: list[dict]) -> list[str]:
    """ìŠ¤íƒ€ì¼ ë³€í™˜: ê¸°ì¡´ ëª¨ë¸ë¡œ 24ì»· ìƒì„±"""
    image_urls = []
    for cut in cuts_prompts:
        # ì—¬ê¸°ì„œëŠ” ê¸°ì¡´ í”„ë¡œì íŠ¸ì˜ ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜ë¥¼ í˜¸ì¶œ
        # GPT Image, Nano Banana ë“± ê¸°ì¡´ ëª¨ë¸ ì‚¬ìš©
        result = await existing_image_generation(
            prompt=f"{style_prompt}, {cut['prompt']}",
            reference_image=photo_url
        )
        image_urls.append(result["url"])
    return image_urls


# â”€â”€â”€ Step 5: ZIP íŒ¨í‚¤ì§• â”€â”€â”€

def package_training_data(image_urls: list[str], trigger_word: str) -> str:
    """ì„ ë³„ëœ ì´ë¯¸ì§€ë¥¼ ZIPìœ¼ë¡œ íŒ¨í‚¤ì§•í•˜ì—¬ ì—…ë¡œë“œ ê°€ëŠ¥í•œ URL ë°˜í™˜"""
    zip_path = f"/tmp/training_{trigger_word}.zip"
    
    with zipfile.ZipFile(zip_path, 'w') as zf:
        for i, url in enumerate(image_urls):
            # ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
            image_data = download_image(url)
            filename = f"{i+1:02d}.jpg"
            zf.writestr(filename, image_data)
            
            # ìº¡ì…˜ íŒŒì¼ ìƒì„±
            caption = f"{trigger_word}, character portrait, various pose and expression"
            zf.writestr(f"{i+1:02d}.txt", caption)
    
    # ZIPì„ í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€ì— ì—…ë¡œë“œí•˜ê³  URL ë°˜í™˜
    upload_url = upload_to_storage(zip_path)
    return upload_url


# â”€â”€â”€ Step 6: LoRA í•™ìŠµ â”€â”€â”€

async def train_lora(training_data_url: str, trigger_word: str) -> dict:
    """fal.aiì—ì„œ LoRA í•™ìŠµ ì‹¤í–‰"""
    result = fal_client.subscribe(
        "fal-ai/flux-lora-portrait-trainer",
        arguments={
            "images_data_url": training_data_url,
            "trigger_word": trigger_word,
            "steps": 1500,
            "create_masks": True,
            "learning_rate": 1e-4,
            "resolution": 1024,
        }
    )
    
    return {
        "lora_url": result["diffusers_lora_file"]["url"],
        "training_time": result.get("training_time"),
    }


# â”€â”€â”€ Step 7: í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ìƒì„± â”€â”€â”€

async def generate_test_images(trigger_word: str, lora_url: str) -> list[str]:
    """í•™ìŠµëœ LoRAë¡œ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ 3ì¥ ìƒì„±"""
    test_prompts = [
        f"{trigger_word}, front view, confident smile, white background",
        f"{trigger_word}, sitting at desk, explaining, office background",
        f"{trigger_word}, full body, standing, waving hand, simple background"
    ]
    
    test_urls = []
    for prompt in test_prompts:
        result = fal_client.subscribe("fal-ai/flux-lora", arguments={
            "prompt": prompt,
            "loras": [{"path": lora_url, "scale": 0.8}],
            "image_size": "square",
            "num_inference_steps": 28,
        })
        test_urls.append(result["images"][0]["url"])
    
    return test_urls


# â”€â”€â”€ ì›¹íˆ° ì”¬ ìƒì„± (ì´í›„ ì‚¬ìš©) â”€â”€â”€

async def generate_scene_with_character(
    trigger_word: str,
    lora_url: str,
    scene_prompt: str,
    lora_scale: float = 0.8
) -> str:
    """í•™ìŠµëœ ìºë¦­í„°ë¡œ ì›¹íˆ° ì”¬ ì´ë¯¸ì§€ ìƒì„±"""
    result = fal_client.subscribe("fal-ai/flux-lora", arguments={
        "prompt": f"{trigger_word}, {scene_prompt}",
        "loras": [{"path": lora_url, "scale": lora_scale}],
        "image_size": "portrait_4_3",
        "num_inference_steps": 28,
    })
    return result["images"][0]["url"]


async def generate_two_character_scene(
    char_a_trigger: str, char_a_lora: str, char_a_scale: float,
    char_b_trigger: str, char_b_lora: str, char_b_scale: float,
    scene_prompt: str
) -> str:
    """2ì¸ ìºë¦­í„° ì”¬ ì´ë¯¸ì§€ ìƒì„±"""
    result = fal_client.subscribe("fal-ai/flux-lora", arguments={
        "prompt": f"{char_a_trigger} and {char_b_trigger}, {scene_prompt}",
        "loras": [
            {"path": char_a_lora, "scale": char_a_scale},
            {"path": char_b_lora, "scale": char_b_scale},
        ],
        "image_size": "landscape_16_9",
        "num_inference_steps": 30,
    })
    return result["images"][0]["url"]
```

---

*ë. ì´ ë¬¸ì„œì˜ ëª¨ë“  ë‚´ìš©ì„ ë¹ ì§ì—†ì´ êµ¬í˜„í•˜ë©´, "ì‚¬ì§„ 1ì¥ â†’ ìºë¦­í„° í•™ìŠµ â†’ ì¼ê´€ì„± ìˆëŠ” ì›¹íˆ° ìƒì„±"ì´ ì™„ì„±ëœë‹¤.*
